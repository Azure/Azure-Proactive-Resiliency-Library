<!DOCTYPE html>
<html><head><script src="/Azure-Proactive-Resiliency-Library/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=Azure-Proactive-Resiliency-Library/livereload" data-no-instant defer></script>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <meta name="description" content="Best practices and resiliency recommendations for AKS and associated resources.">
    
    <link rel="alternate" type="application/rss+xml" href="http://localhost:1313/Azure-Proactive-Resiliency-Library/services/container/aks/index.xml" title="Azure Proactive Resiliency Library (APRL)" />
    <link rel="canonical" href="http://localhost:1313/Azure-Proactive-Resiliency-Library/services/container/aks/">

    <title>
        
        AKS | Azure Proactive Resiliency Library (APRL)
        
    </title>

    
    <link href="http://localhost:1313/Azure-Proactive-Resiliency-Library/css/fontawesome.min.css" rel="stylesheet">

    
    <link rel="stylesheet" href="http://localhost:1313/Azure-Proactive-Resiliency-Library/css/ace.min.css">

    

    
    

  
  <script type="text/javascript">
    (function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "kxpusfirv0");
  </script>

  
</head>
<body>

  <script src="https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js"></script>
  <script>addBackToTop({
      diameter: 75,
      backgroundColor: 'rgb(0, 123, 255)',
      textColor: '#ffffff',
      cornerOffset: 25,
      scrollDuration: 300
    })</script><nav class="navbar navbar-expand-lg navbar-dark bg-primary shadow sticky-top" id="navbarMain">
    <div class="container">
        <div>
            <a class="navbar-brand" href="/Azure-Proactive-Resiliency-Library">
                
                    <img src="/Azure-Proactive-Resiliency-Library/media/img/aprl-white.png" />
                
                Azure Proactive Resiliency Library (APRL)
            </a>
        </div>
        
            <button class="navbar-toggler navbar-toggler-right collapsed" type="button" data-toggle="collapse" data-target="#navbarMainCollapse" aria-controls="navbarMainCollapse" aria-expanded="false" aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarMainCollapse">
              <ul class="navbar-nav ml-auto">
                            <li class="nav-item">
                                <a class="nav-link" href="https://aka.ms/waf" target="_blank">
                                  Well-Architected Framework
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="https://aka.ms/aprl/repo" target="_blank">
                                  Source Code <i class='fab fa-github'></i>
                                </a>
                            </li>
              </ul>
            </div>
    </div>
    
    
</nav>
<div class="container-fluid">
    <div class="row">

      <div class="docs-sidenav order-0 col-12 col-md-3 col-lg-2 col-xl-2 position-sticky border-right"><nav class="navbar navbar-expand-md navbar-light pl-0">
    <button class="navbar-toggler navbar-toggler-right collapsed" type="button" data-toggle="collapse" data-target="#sidenav-left-collapse" aria-controls="sidenav-left-collapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

     <div class="collapse navbar-collapse align-items-start flex-column" id="sidenav-left-collapse">
            <form class="form-inline my-2 my-lg-0 searchbox">
                <input class="form-control mr-sm-2 w-100" data-search-input id="search-by" type="text" placeholder="Search">
            </form>

        

         <ul class="navbar-nav flex-column pt-3">
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/" class="nav-item my-1 parent haschildren
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/"><h6>Azure Services</h6></a>
        
        <ul class="list-unstyled ml-2">
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/ai-ml/" class="nav-item my-1 haschildren
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/ai-ml/"><h6>AI and ML</h6></a>
        
        <ul class="list-unstyled ml-2">
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/ai-ml/databricks/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/ai-ml/databricks/"><h6>Azure Databricks</h6></a>
        
    </li>
        </ul>
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/batch/" class="nav-item my-1 haschildren
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/batch/"><h6>Batch</h6></a>
        
        <ul class="list-unstyled ml-2">
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/batch/batch-accounts/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/batch/batch-accounts/"><h6>Batch Accounts</h6></a>
        
    </li>
        </ul>
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/compute/" class="nav-item my-1 haschildren
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/compute/"><h6>Compute</h6></a>
        
        <ul class="list-unstyled ml-2">
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/compute/site-recovery/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/compute/site-recovery/"><h6>Azure Site Recovery</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/compute/compute-gallery/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/compute/compute-gallery/"><h6>Compute Gallery</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/compute/image-templates/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/compute/image-templates/"><h6>Image Templates</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/compute/virtual-machine-scale-sets/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/compute/virtual-machine-scale-sets/"><h6>Virtual Machine Scale Sets</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/compute/virtual-machines/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/compute/virtual-machines/"><h6>Virtual Machines</h6></a>
        
    </li>
        </ul>
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/container/" class="nav-item my-1 parent haschildren
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/container/"><h6>Containers</h6></a>
        
        <ul class="list-unstyled ml-2">
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/container/aks/" class="nav-item my-1 active
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/container/aks/"><h6>AKS</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/container/container-registry/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/container/container-registry/"><h6>Container Registry</h6></a>
        
    </li>
        </ul>
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/database/" class="nav-item my-1 haschildren
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/database/"><h6>Databases</h6></a>
        
        <ul class="list-unstyled ml-2">
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/database/sqldb/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/database/sqldb/"><h6>SQL DB</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/database/cosmosdb/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/database/cosmosdb/"><h6>Cosmos DB</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/database/db-for-mysql/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/database/db-for-mysql/"><h6>DB for MySQL</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/database/db-for-postgresql/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/database/db-for-postgresql/"><h6>DB for PostgreSQL</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/database/redis-cache/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/database/redis-cache/"><h6>Redis Cache</h6></a>
        
    </li>
        </ul>
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/general/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/general/"><h6>General</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/hybrid/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/hybrid/"><h6>Hybrid</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/integration/" class="nav-item my-1 haschildren
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/integration/"><h6>Integration</h6></a>
        
        <ul class="list-unstyled ml-2">
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/integration/api-management/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/integration/api-management/"><h6>Api Management</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/integration/event-grid/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/integration/event-grid/"><h6>Event Grid</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/integration/event-hub/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/integration/event-hub/"><h6>Event Hub</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/integration/service-bus/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/integration/service-bus/"><h6>Service Bus</h6></a>
        
    </li>
        </ul>
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/iot/" class="nav-item my-1 haschildren
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/iot/"><h6>Internet of Things</h6></a>
        
        <ul class="list-unstyled ml-2">
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/iot/iot-hub/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/iot/iot-hub/"><h6>IoT Hub</h6></a>
        
    </li>
        </ul>
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/management/" class="nav-item my-1 haschildren
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/management/"><h6>Management</h6></a>
        
        <ul class="list-unstyled ml-2">
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/management/automation-account/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/management/automation-account/"><h6>Automation Account</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/management/management-group/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/management/management-group/"><h6>Management Groups</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/management/resource-group/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/management/resource-group/"><h6>Resource Groups</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/management/subscription/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/management/subscription/"><h6>Subscription</h6></a>
        
    </li>
        </ul>
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/migration/" class="nav-item my-1 haschildren
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/migration/"><h6>Migration</h6></a>
        
        <ul class="list-unstyled ml-2">
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/migration/azure-backup/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/migration/azure-backup/"><h6>Azure Backup</h6></a>
        
    </li>
        </ul>
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/monitoring/" class="nav-item my-1 haschildren
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/monitoring/"><h6>Monitoring</h6></a>
        
        <ul class="list-unstyled ml-2">
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/monitoring/application-insights/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/monitoring/application-insights/"><h6>Application Insights</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/monitoring/log-analytics/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/monitoring/log-analytics/"><h6>Log Analytics</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/monitoring/resource-health-alerts/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/monitoring/resource-health-alerts/"><h6>Resource Health Alerts</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/monitoring/service-health-alerts/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/monitoring/service-health-alerts/"><h6>Service Health Alerts</h6></a>
        
    </li>
        </ul>
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/networking/" class="nav-item my-1 haschildren
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/networking/"><h6>Networking</h6></a>
        
        <ul class="list-unstyled ml-2">
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/networking/application-gateway/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/networking/application-gateway/"><h6>Application Gateway</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/networking/ddos-protection-plans/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/networking/ddos-protection-plans/"><h6>DDoS Protection Plans</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/networking/expressroute-circuits/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/networking/expressroute-circuits/"><h6>ExpressRoute Circuits</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/networking/expressroute-connection/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/networking/expressroute-connection/"><h6>ExpressRoute Connection</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/networking/expressroute-direct/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/networking/expressroute-direct/"><h6>ExpressRoute Direct</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/networking/expressroute-gateway/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/networking/expressroute-gateway/"><h6>ExpressRoute Gateway</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/networking/expressroute-traffic-collector/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/networking/expressroute-traffic-collector/"><h6>ExpressRoute Traffic Collector</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/networking/firewall/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/networking/firewall/"><h6>Firewall</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/networking/front-door/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/networking/front-door/"><h6>Front Door</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/networking/load-balancer/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/networking/load-balancer/"><h6>Load Balancer</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/networking/network-security-group/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/networking/network-security-group/"><h6>Network Security Group</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/networking/network-watcher/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/networking/network-watcher/"><h6>Network Watcher</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/networking/private-dns-zones/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/networking/private-dns-zones/"><h6>Private DNS Zones</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/networking/private-endpoints/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/networking/private-endpoints/"><h6>Private Endpoints</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/networking/public-ip/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/networking/public-ip/"><h6>Public Ip</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/networking/route-table/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/networking/route-table/"><h6>Route Table</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/networking/traffic-manager/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/networking/traffic-manager/"><h6>Traffic Manager</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/networking/virtual-networks/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/networking/virtual-networks/"><h6>Virtual Networks</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/networking/vpn-gateway/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/networking/vpn-gateway/"><h6>VPN Gateway</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/networking/web-application-firewall/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/networking/web-application-firewall/"><h6>Web Application Firewall</h6></a>
        
    </li>
        </ul>
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/security/" class="nav-item my-1 haschildren
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/security/"><h6>Security</h6></a>
        
        <ul class="list-unstyled ml-2">
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/security/key-vault/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/security/key-vault/"><h6>Key Vault</h6></a>
        
    </li>
        </ul>
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/specialized-workloads/" class="nav-item my-1 haschildren
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/specialized-workloads/"><h6>Specialized Workloads</h6></a>
        
        <ul class="list-unstyled ml-2">
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/specialized-workloads/azure-hpc/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/specialized-workloads/azure-hpc/"><h6>Azure High Performance Computing</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/specialized-workloads/azure-virtual-desktop/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/specialized-workloads/azure-virtual-desktop/"><h6>Azure Virtual Desktop</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/specialized-workloads/azure-vmware-solution/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/specialized-workloads/azure-vmware-solution/"><h6>Azure VMware Solution</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/specialized-workloads/sap-on-azure/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/specialized-workloads/sap-on-azure/"><h6>SAP on Azure</h6></a>
        
    </li>
        </ul>
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/storage/" class="nav-item my-1 haschildren
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/storage/"><h6>Storage</h6></a>
        
        <ul class="list-unstyled ml-2">
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/storage/azure-netapp-files/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/storage/azure-netapp-files/"><h6>Azure NetApp Files</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/storage/storage-account/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/storage/storage-account/"><h6>Storage Accounts (Blob/Azure Data Lake Storage Gen2)</h6></a>
        
    </li>
        </ul>
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/web/" class="nav-item my-1 haschildren
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/web/"><h6>Web</h6></a>
        
        <ul class="list-unstyled ml-2">
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/web/app-service-plan/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/web/app-service-plan/"><h6>App Service Plan</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/web/signalr/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/web/signalr/"><h6>SignalR</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/web/web-app/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/web/web-app/"><h6>Web App</h6></a>
        
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/well-architected/" class="nav-item my-1 haschildren
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/well-architected/"><h6>Well Architected Framework</h6></a>
        
        <ul class="list-unstyled ml-2">
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/well-architected/1-define/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/well-architected/1-define/"><h6>1 - Define</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/well-architected/2-design/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/well-architected/2-design/"><h6>2 - Design</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/well-architected/3-test/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/well-architected/3-test/"><h6>3 - Test</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/well-architected/4-deploy/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/well-architected/4-deploy/"><h6>4 - Deploy</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/well-architected/5-monitor/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/well-architected/5-monitor/"><h6>5 - Monitor</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/well-architected/6-respond/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/well-architected/6-respond/"><h6>6 - Respond</h6></a>
        
    </li>
        </ul>
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/contributing/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/contributing/"><h6>Contributing</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/privacy/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/privacy/"><h6>Privacy</h6></a>
        
    </li>
        </ul>
    </div>
</nav>


</div>
        <div class="main col-12 order-1 col-md-9 col-lg-10 col-xl-10 py-3">
          

<div class="d-flex flex-column">
    <h1 class="js-title">AKS</h1>
    <div class="d-flex align-items-center">
        
    </div>
</div>

<hr>


<p>The presented resiliency recommendations in this guidance include Aks and associated settings.</p>
<h2 id="summary-of-recommendations">Summary of Recommendations
  <a href="#summary-of-recommendations">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h2>

<div class="table table-striped" role="alert">
    <table>
<thead>
<tr>
<th style="text-align:left">Recommendation</th>
<th style="text-align:center">Category</th>
<th style="text-align:center">Impact</th>
<th style="text-align:center">State</th>
<th style="text-align:center">ARG Query Available</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><a href="#aks-1---deploy-aks-cluster-across-availability-zones">AKS-1 - Deploy AKS cluster across availability zones</a></td>
<td style="text-align:center">Availability</td>
<td style="text-align:center">High</td>
<td style="text-align:center">Preview</td>
<td style="text-align:center">Yes</td>
</tr>
<tr>
<td style="text-align:left"><a href="#aks-2---isolate-system-and-application-pods">AKS-2 - Isolate system and application pods</a></td>
<td style="text-align:center">Governance</td>
<td style="text-align:center">High</td>
<td style="text-align:center">Preview</td>
<td style="text-align:center">Yes</td>
</tr>
<tr>
<td style="text-align:left"><a href="#aks-3---disable-local-accounts">AKS-3 - Disable local accounts</a></td>
<td style="text-align:center">Access &amp; Security</td>
<td style="text-align:center">High</td>
<td style="text-align:center">Preview</td>
<td style="text-align:center">Yes</td>
</tr>
<tr>
<td style="text-align:left"><a href="#aks-4---configure-azure-cni-networking-for-dynamic-allocation-of-ips">AKS-4 - Configure Azure CNI networking for dynamic allocation of IPs</a></td>
<td style="text-align:center">Networking</td>
<td style="text-align:center">Medium</td>
<td style="text-align:center">Preview</td>
<td style="text-align:center">Yes</td>
</tr>
<tr>
<td style="text-align:left"><a href="#aks-5---enable-the-cluster-auto-scaler-on-an-existing-cluster">AKS-5 - Enable the cluster auto-scaler on an existing cluster</a></td>
<td style="text-align:center">System Efficiency</td>
<td style="text-align:center">High</td>
<td style="text-align:center">Preview</td>
<td style="text-align:center">Yes</td>
</tr>
<tr>
<td style="text-align:left"><a href="#aks-6---back-up-azure-kubernetes-service">AKS-6 - Back up Azure Kubernetes Service</a></td>
<td style="text-align:center">Disaster Recovery</td>
<td style="text-align:center">Low</td>
<td style="text-align:center">Preview</td>
<td style="text-align:center">No</td>
</tr>
<tr>
<td style="text-align:left"><a href="#aks-7---plan-an-aks-version-upgrade">AKS-7 - Plan an AKS version upgrade</a></td>
<td style="text-align:center">Compliance</td>
<td style="text-align:center">High</td>
<td style="text-align:center">Preview</td>
<td style="text-align:center">No</td>
</tr>
<tr>
<td style="text-align:left"><a href="#aks-8---ensure-that-persistent-volumes-in-storage-account-are-redundant-for-pods-with-stateful-applications">AKS-8 - Ensure that Persistent Volumes in storage account are redundant for Pods with stateful applications</a></td>
<td style="text-align:center">Availability</td>
<td style="text-align:center">Low</td>
<td style="text-align:center">Preview</td>
<td style="text-align:center">No</td>
</tr>
<tr>
<td style="text-align:left"><a href="#aks-9---upgrade-persistent-volumes-with-deprecated-version-to-azure-csi-drivers">AKS-9 - Upgrade Persistent Volumes with deprecated version to Azure CSI drivers</a></td>
<td style="text-align:center">Storage</td>
<td style="text-align:center">High</td>
<td style="text-align:center">Preview</td>
<td style="text-align:center">No</td>
</tr>
<tr>
<td style="text-align:left"><a href="#aks-10---implement-resource-quota-to-ensure-that-kubernetes-resources-do-not-exceed-hard-resource-limits">AKS-10 - Implement Resource Quota to ensure that Kubernetes resources do not exceed hard resource limits.</a></td>
<td style="text-align:center">System Efficiency</td>
<td style="text-align:center">Low</td>
<td style="text-align:center">Preview</td>
<td style="text-align:center">No</td>
</tr>
<tr>
<td style="text-align:left"><a href="#aks-11---attach-virtual-nodes-aci-to-the-aks-cluster">AKS-11 - Attach Virtual Nodes (ACI) to the AKS cluster</a></td>
<td style="text-align:center">System Efficiency</td>
<td style="text-align:center">Low</td>
<td style="text-align:center">Preview</td>
<td style="text-align:center">No</td>
</tr>
<tr>
<td style="text-align:left"><a href="#aks-12---update-aks-tier-to-standard">AKS-12 - Update AKS tier to Standard</a></td>
<td style="text-align:center">Availability</td>
<td style="text-align:center">High</td>
<td style="text-align:center">Preview</td>
<td style="text-align:center">Yes</td>
</tr>
<tr>
<td style="text-align:left"><a href="#aks-13---enable-aks-monitoring">AKS-13 - Enable AKS Monitoring</a></td>
<td style="text-align:center">Monitoring</td>
<td style="text-align:center">High</td>
<td style="text-align:center">Preview</td>
<td style="text-align:center">Yes</td>
</tr>
<tr>
<td style="text-align:left"><a href="#aks-14---use-ephemeral-disks-on-aks-clusters">AKS-14 - Use Ephemeral Disks on AKS clusters</a></td>
<td style="text-align:center">System Efficiency</td>
<td style="text-align:center">Medium</td>
<td style="text-align:center">Preview</td>
<td style="text-align:center">No</td>
</tr>
<tr>
<td style="text-align:left"><a href="#aks-15---enable-and-remediate-azure-policies-configured-for-aks">AKS-15 - Enable and remediate Azure Policies configured for AKS</a></td>
<td style="text-align:center">Governance</td>
<td style="text-align:center">Low</td>
<td style="text-align:center">Preview</td>
<td style="text-align:center">No</td>
</tr>
<tr>
<td style="text-align:left"><a href="#aks-16---enable-gitops-when-using-devops-frameworks">AKS-16 - Enable GitOps when using DevOps frameworks</a></td>
<td style="text-align:center">Automation</td>
<td style="text-align:center">Low</td>
<td style="text-align:center">Preview</td>
<td style="text-align:center">Yes</td>
</tr>
<tr>
<td style="text-align:left"><a href="#aks-17---configure-affinity-or-anti-affinity-rules-based-on-application-requirements">AKS-17 - Configure affinity or anti-affinity rules based on application requirements</a></td>
<td style="text-align:center">Availability</td>
<td style="text-align:center">High</td>
<td style="text-align:center">Preview</td>
<td style="text-align:center">No</td>
</tr>
<tr>
<td style="text-align:left"><a href="#aks-18---configures-pods-liveness-readiness-and-startup-probes">AKS-18 - Configures Pods Liveness, Readiness, and Startup Probes</a></td>
<td style="text-align:center">Availability</td>
<td style="text-align:center">High</td>
<td style="text-align:center">Preview</td>
<td style="text-align:center">No</td>
</tr>
<tr>
<td style="text-align:left"><a href="#aks-19---configure-pod-replica-sets-in-production-applications-to-guarantee-availability">AKS-19 - Configure Pod replica sets in production applications to guarantee availability</a></td>
<td style="text-align:center">Availability</td>
<td style="text-align:center">High</td>
<td style="text-align:center">Preview</td>
<td style="text-align:center">No</td>
</tr>
<tr>
<td style="text-align:left"><a href="#aks-20---configure-system-nodepool-count">AKS-20 - Configure system nodepool count</a></td>
<td style="text-align:center">Availability</td>
<td style="text-align:center">High</td>
<td style="text-align:center">Preview</td>
<td style="text-align:center">Yes</td>
</tr>
<tr>
<td style="text-align:left"><a href="#aks-21---configure-user-nodepool-count">AKS-21 - Configure user nodepool count</a></td>
<td style="text-align:center">Availability</td>
<td style="text-align:center">High</td>
<td style="text-align:center">Preview</td>
<td style="text-align:center">Yes</td>
</tr>
<tr>
<td style="text-align:left"><a href="#aks-22---configure-pod-disruption-budgets-pdbs">AKS-22 - Configure pod disruption budgets (PDBs)</a></td>
<td style="text-align:center">Availability</td>
<td style="text-align:center">Medium</td>
<td style="text-align:center">Preview</td>
<td style="text-align:center">No</td>
</tr>
<tr>
<td style="text-align:left"><a href="#aks-23---nodepool-subnet-size-needs-to-accommodate-maximum-auto-scale-settings">AKS-23 - Nodepool subnet size needs to accommodate maximum auto-scale settings</a></td>
<td style="text-align:center">Availability</td>
<td style="text-align:center">High</td>
<td style="text-align:center">Preview</td>
<td style="text-align:center">No</td>
</tr>
<tr>
<td style="text-align:left"><a href="#aks-24---enforce-resource-quotas-at-the-namespace-level">AKS-24 - Enforce resource quotas at the namespace level</a></td>
<td style="text-align:center">Availability</td>
<td style="text-align:center">High</td>
<td style="text-align:center">Preview</td>
<td style="text-align:center">No</td>
</tr>
</tbody>
</table>

</div>


<div class="alert alert-info" role="alert">
    Definitions of states can be found <a href="http://localhost:1313/Azure-Proactive-Resiliency-Library/#definitions-of-terms-used-in-aprl">here</a>
</div>

<h2 id="recommendations-details">Recommendations Details
  <a href="#recommendations-details">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h2>
<h3 id="aks-1---deploy-aks-cluster-across-availability-zones">AKS-1 - Deploy AKS cluster across availability zones
  <a href="#aks-1---deploy-aks-cluster-across-availability-zones">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: Availability</strong></p>
<p><strong>Impact: High</strong></p>
<p><strong>Guidance</strong></p>
<p>Azure Availability Zones are a high-availability offering that protects applications and data from datacenter-level failures. Availability Zones are unique physical locations within an Azure region that are equipped with independent power, cooling, and networking. Each Availability Zone is made up of one or more datacenters and is designed to be highly available and fault tolerant.</p>
<p>By deploying resources such as aks clusters, virtual machines, storage, and databases across multiple Availability Zones in the same region, you can protect your applications and data from datacenter-level failures. If one Availability Zone goes down, the other Availability Zones in the region can continue to provide service.</p>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/azure/aks/availability-zones">AKS Availability Zones</a></li>
<li><a href="https://learn.microsoft.com/en-us/azure/virtual-machine-scale-sets/virtual-machine-scale-sets-use-availability-zones#zone-balancing">Zone Balancing</a></li>
</ul>
<p><strong>Resource Graph Query</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_d8998e5677" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_d8998e5677">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_bda287713d">
        Copy
        </button>
    </div>
    <div id="clipboard_bda287713d">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> Azure Resource Graph Query
</span></span><span style="display:flex;"><span><span style="color:#f92672">//</span> <span style="color:#66d9ef">Returns</span> AKS clusters that <span style="color:#66d9ef">do</span> <span style="color:#66d9ef">not</span> have <span style="color:#66d9ef">any</span> availability zones enabled
</span></span><span style="display:flex;"><span>resources
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> <span style="color:#66d9ef">type</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#39;microsoft.containerservice/managedclusters&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> project id, name, <span style="color:#66d9ef">location</span>, properties.agentPoolProfiles
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> mv<span style="color:#f92672">-</span>expand properties_agentPoolProfiles
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> isempty(array_length(properties_agentPoolProfiles.availabilityZones))
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> project recommendationId<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;aks-1&#34;</span>, id, name, tags, param1<span style="color:#f92672">=</span>strcat(<span style="color:#e6db74">&#34;nodePoolName: &#34;</span>, properties_agentPoolProfiles.name), param2<span style="color:#f92672">=</span>strcat(<span style="color:#e6db74">&#34;orchestratorVersion: &#34;</span>, properties_agentPoolProfiles.orchestratorVersion), param3<span style="color:#f92672">=</span>strcat(<span style="color:#e6db74">&#34;currentOrchestratorVersion: &#34;</span>, properties_agentPoolProfiles.currentOrchestratorVersion), param4<span style="color:#f92672">=</span>strcat(<span style="color:#e6db74">&#34;numberOfZones: &#34;</span>, iff(isempty(array_length(properties_agentPoolProfiles.availabilityZones)), <span style="color:#ae81ff">0</span>, array_length(properties_agentPoolProfiles.availabilityZones)))
</span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>
<h3 id="aks-2---isolate-system-and-application-pods">AKS-2 - Isolate system and application pods
  <a href="#aks-2---isolate-system-and-application-pods">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: Governance</strong></p>
<p><strong>Impact: High</strong></p>
<p><strong>Guidance</strong></p>
<p>AKS automatically assigns the label kubernetes.azure.com/mode: system to nodes in a system node pool. This label signals to AKS that system pods should be scheduled on nodes in this pool. However, you can still schedule application pods on these nodes if you choose to do so.</p>
<p>To prevent misconfigured or rogue application pods from accidentally killing system pods, it is recommended that you isolate critical system pods from your application pods. This can be achieved by scheduling system pods on dedicated node pools or by using node selectors to ensure that system pods are only scheduled on nodes with the kubernetes.azure.com/mode: system label.</p>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/azure/aks/use-system-pools?tabs=azure-cli#system-and-user-node-pools">System and user node pools</a></li>
</ul>
<p><strong>Resource Graph Query</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_caf107c384" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_caf107c384">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_513aa5a935">
        Copy
        </button>
    </div>
    <div id="clipboard_513aa5a935">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> Azure Resource Graph Query
</span></span><span style="display:flex;"><span><span style="color:#f92672">//</span> <span style="color:#66d9ef">Returns</span> <span style="color:#66d9ef">each</span> AKS <span style="color:#66d9ef">cluster</span> <span style="color:#66d9ef">with</span> nodepools that <span style="color:#66d9ef">do</span> <span style="color:#66d9ef">not</span> have taints <span style="color:#66d9ef">set</span>
</span></span><span style="display:flex;"><span>resources
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> <span style="color:#66d9ef">type</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;microsoft.containerservice/managedclusters&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> mv<span style="color:#f92672">-</span>expand agentPoolProfile <span style="color:#f92672">=</span> properties.agentPoolProfiles
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> extend taint <span style="color:#f92672">=</span> tostring(parse_json(agentPoolProfile.nodeTaints))
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> extend nodePool <span style="color:#f92672">=</span> tostring(parse_json(agentPoolProfile.name))
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> isempty(taint)
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> project recommendationid<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;aks-2&#34;</span>, id, name, tags, param1<span style="color:#f92672">=</span>strcat(<span style="color:#e6db74">&#34;nodepoolName: &#34;</span>, nodePool), param2<span style="color:#f92672">=</span>strcat(<span style="color:#e6db74">&#34;taint: &#34;</span>, iff(isempty(taint), <span style="color:#e6db74">&#34;None&#34;</span>, taint))
</span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>
<h3 id="aks-3---disable-local-accounts">AKS-3 - Disable local accounts
  <a href="#aks-3---disable-local-accounts">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: Access &amp; Security</strong></p>
<p><strong>Impact: High</strong></p>
<p><strong>Guidance</strong></p>
<p>Local Kubernetes accounts provide a legacy non-auditable means of accessing an AKS cluster and are not recommended for use. Enabling Microsoft Entra integration on an AKS cluster provides several benefits for managing access to the cluster. By using Microsoft Entra, you can centralize user and group management, enforce multi-factor authentication, and enable role-based access control (RBAC) for fine-grained access control to cluster resources. Additionally, Microsoft Entra provides a secure and scalable authentication mechanism that can be integrated with other Azure services and third-party identity providers.</p>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/azure/aks/concepts-identity#azure-ad-integration">Entra integration</a></li>
<li><a href="https://learn.microsoft.com/en-us/azure/aks/manage-azure-rbac?source=recommendations">Use Azure role-based access control for AKS</a></li>
<li><a href="https://learn.microsoft.com/en-us/azure/aks/manage-local-accounts-managed-azure-ad?source=recommendations">Manage AKS local accounts</a></li>
</ul>
<p><strong>Resource Graph Query</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_2951831233" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_2951831233">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_18f55b663c">
        Copy
        </button>
    </div>
    <div id="clipboard_18f55b663c">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> Azure Resource Graph Query
</span></span><span style="display:flex;"><span><span style="color:#f92672">//</span> <span style="color:#66d9ef">Returns</span> a list <span style="color:#66d9ef">of</span> AKS clusters <span style="color:#66d9ef">not</span> <span style="color:#66d9ef">using</span> AAD enabled
</span></span><span style="display:flex;"><span>resources
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> <span style="color:#66d9ef">type</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;microsoft.containerservice/managedclusters&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> extend aadProfile <span style="color:#f92672">=</span> tostring (parse_json(properties.aadProfile))
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> extend disablelocalAdmin <span style="color:#f92672">=</span> tostring(parse_json(properties.disableLocalAccounts))
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> extend RBAC <span style="color:#f92672">=</span> tostring(parse_json(properties.enableRBAC))
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> RBAC <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;false&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> project recommendationId<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;aks-3&#34;</span>, name, id, tags, param1<span style="color:#f92672">=</span>strcat(<span style="color:#e6db74">&#34;aadProfile: &#34;</span>, aadProfile), param2<span style="color:#f92672">=</span>strcat(<span style="color:#e6db74">&#34;disablelocalAdmin: &#34;</span>,disablelocalAdmin), param3<span style="color:#f92672">=</span>strcat(<span style="color:#e6db74">&#34;RBAC: &#34;</span>, RBAC)
</span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>
<h3 id="aks-4---configure-azure-cni-networking-for-dynamic-allocation-of-ips">AKS-4 - Configure Azure CNI networking for dynamic allocation of IPs
  <a href="#aks-4---configure-azure-cni-networking-for-dynamic-allocation-of-ips">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: Networking</strong></p>
<p><strong>Impact: Medium</strong></p>
<p><strong>Guidance</strong></p>
<p>The Azure CNI networking solution provides several benefits for managing IP addresses and network connectivity for cluster pods including dynamic allocation of IPs to pods, allowing node and pod subnets to scale independently, direct network connectivity between pods and resources in the VNET and allowing different network policies for pods and nodes. It also supports different networking policies including Azure Network Policies and Calico.</p>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/azure/aks/configure-azure-cni-dynamic-ip-allocation">Configure Azure CNI networking</a></li>
<li><a href="https://learn.microsoft.com/en-us/azure/aks/azure-cni-overlay">Configure Azure CNI Overlay networking</a></li>
</ul>
<p><strong>Resource Graph Query</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_eeeb3d5048" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_eeeb3d5048">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_c242433983">
        Copy
        </button>
    </div>
    <div id="clipboard_c242433983">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> Azure Resource Graph Query
</span></span><span style="display:flex;"><span><span style="color:#f92672">//</span> <span style="color:#66d9ef">Check</span> AKS Clusters <span style="color:#66d9ef">using</span> kubenet network profile
</span></span><span style="display:flex;"><span>resources
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> <span style="color:#66d9ef">type</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;microsoft.containerservice/managedclusters&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> extend networkProfile <span style="color:#f92672">=</span> tostring (parse_json(properties.networkProfile.networkPlugin))
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> networkProfile <span style="color:#f92672">==</span><span style="color:#e6db74">&#34;kubenet&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> project recommendationId<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;aks-4&#34;</span>, name, id, tags, param1<span style="color:#f92672">=</span>strcat(<span style="color:#e6db74">&#34;networkProfile :&#34;</span>,networkProfile)
</span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>
<h3 id="aks-5---enable-the-cluster-auto-scaler-on-an-existing-cluster">AKS-5 - Enable the cluster auto-scaler on an existing cluster
  <a href="#aks-5---enable-the-cluster-auto-scaler-on-an-existing-cluster">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: System Efficiency</strong></p>
<p><strong>Impact: High</strong></p>
<p><strong>Guidance</strong></p>
<p>The cluster auto-scaler automatically scales the number of nodes in a node pool based on pod resource requests and the available capacity in the cluster. It helps ensure that the cluster can scale according to demand and prevent outages.</p>
<p>If the cluster has availability zones enabled, the following configuration changes need to be verified or established:</p>
<ul>
<li>Persistent Volumes - If the cluster is using persistent volumes backed by Azure Storage, ensure you have one nodepool per availability zone. Persistent volumes do not work across AZs and the auto-scaler could fail to create new pods if the nodepool cannot access the persistent volume.</li>
<li>Multiple Nodepools per Zone - If the cluster has multiple nodepools per AZ, enable the <code>--balance-similar-node-groups</code> property through the auto-scaler profile. This feature detects similar nodepools and balances the number of nodes across them.</li>
</ul>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://learn.microsoft.com/azure/aks/cluster-autoscaler?tabs=azure-cli">Use the Cluster Autoscaler on AKS</a></li>
<li><a href="https://learn.microsoft.com/azure/aks/operator-best-practices-advanced-scheduler">Best practices for advanced scheduler features</a></li>
<li><a href="https://learn.microsoft.com/azure/aks/best-practices-performance-scale-large#node-pool-scaling">Node pool scaling considerations and best practices</a></li>
<li><a href="https://learn.microsoft.com/azure/aks/operator-best-practices-scheduler">Best practices for basic scheduler features</a></li>
</ul>
<p><strong>Resource Graph Query</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_ad48523ebb" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_ad48523ebb">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_0747a9ff97">
        Copy
        </button>
    </div>
    <div id="clipboard_0747a9ff97">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> Azure Resource Graph Query
</span></span><span style="display:flex;"><span><span style="color:#f92672">//</span> Find AKS clusters <span style="color:#66d9ef">with</span> auto<span style="color:#f92672">-</span>scaling disabled
</span></span><span style="display:flex;"><span>Resources
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> <span style="color:#66d9ef">type</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;microsoft.containerservice/managedclusters&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> extend autoScaling <span style="color:#f92672">=</span> tostring (parse_json(properties.agentPoolProfiles.[<span style="color:#ae81ff">0</span>].enableAutoScaling))
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> autoScaling <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;false&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> project recommendationId<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;aks-5&#34;</span>, name, id, tags, param1<span style="color:#f92672">=</span>strcat(<span style="color:#e6db74">&#34;autoScaling :&#34;</span>, autoScaling)
</span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>
<h3 id="aks-6---back-up-azure-kubernetes-service">AKS-6 - Back up Azure Kubernetes Service
  <a href="#aks-6---back-up-azure-kubernetes-service">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: Disaster Recovery</strong></p>
<p><strong>Impact: Low</strong></p>
<p><strong>Guidance</strong></p>
<p>AKS is increasingly being used for stateful applications that require a backup strategy. Azure Backup now allows you to back up AKS clusters (cluster resources and persistent volumes attached to the cluster) using a backup extension, which must be installed in the cluster. Backup vault communicates with the cluster via this Backup Extension to perform backup and restore operations.&quot;</p>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/azure/backup/azure-kubernetes-service-cluster-backup">AKS Backups</a></li>
<li><a href="https://learn.microsoft.com/en-us/azure/aks/operator-best-practices-storage">Best Practices for AKS Backups</a></li>
</ul>
<p><strong>Resource Graph Query</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_4c3a56645a" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_4c3a56645a">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_bc1cd98b55">
        Copy
        </button>
    </div>
    <div id="clipboard_bc1cd98b55">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> Azure Resource Graph Query
</span></span><span style="display:flex;"><span><span style="color:#f92672">//</span> Find AKS clusters that <span style="color:#66d9ef">do</span> <span style="color:#66d9ef">not</span> have backup enabled
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>resources
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> <span style="color:#66d9ef">type</span> <span style="color:#f92672">=~</span> <span style="color:#e6db74">&#39;Microsoft.ContainerService/managedClusters&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> extend lname <span style="color:#f92672">=</span> tolower(name)
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">join</span> kind<span style="color:#f92672">=</span>leftouter(recoveryservicesresources
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> <span style="color:#66d9ef">type</span> <span style="color:#f92672">=~</span> <span style="color:#e6db74">&#39;microsoft.dataprotection/backupvaults/backupinstances&#39;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> extend lname <span style="color:#f92672">=</span> tolower(tostring(split(properties.dataSourceInfo.resourceID, <span style="color:#e6db74">&#39;/&#39;</span>)[<span style="color:#ae81ff">8</span>]))
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> extend protectionState <span style="color:#f92672">=</span> properties.currentProtectionState
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">|</span> project lname, protectionState) <span style="color:#66d9ef">on</span> lname
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> protectionState <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#39;ProtectionConfigured&#39;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> extend param1 <span style="color:#f92672">=</span> iif(<span style="color:#66d9ef">isnull</span>(protectionState), <span style="color:#e6db74">&#39;Protection Not Configured&#39;</span>, strcat(<span style="color:#e6db74">&#39;Protection State: &#39;</span>, protectionState))
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> project recommendationID <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;aks-6&#34;</span>, name, id, tags, param1
</span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>
<h3 id="aks-7---plan-an-aks-version-upgrade">AKS-7 - Plan an AKS version upgrade
  <a href="#aks-7---plan-an-aks-version-upgrade">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: Compliance</strong></p>
<p><strong>Impact: High</strong></p>
<p><strong>Guidance</strong></p>
<p>Minor version releases include new features and improvements. Patch releases are more frequent (sometimes weekly) and are intended for critical bug fixes within a minor version. Patch releases include fixes for security vulnerabilities or major bugs.
If you&rsquo;re running an unsupported Kubernetes version, you&rsquo;ll be asked to upgrade when requesting support for the cluster. Clusters running unsupported Kubernetes releases aren&rsquo;t covered by the AKS support policies.</p>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://learn.microsoft.com/azure/aks/operator-best-practices-cluster-security?tabs=azure-cli#regularly-update-to-the-latest-version-of-kubernetes">Updating to the latest AKS version</a></li>
<li><a href="https://learn.microsoft.com/azure/aks/upgrade-cluster?tabs=azure-cli">Upgrade cluster</a></li>
<li><a href="https://learn.microsoft.com/azure/aks/auto-upgrade-cluster">Auto-upgrading cluster</a></li>
</ul>
<p><strong>Resource Graph Query</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_c8e45339d9" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_c8e45339d9">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_f8ad57f9af">
        Copy
        </button>
    </div>
    <div id="clipboard_f8ad57f9af">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> cannot<span style="color:#f92672">-</span>be<span style="color:#f92672">-</span>validated<span style="color:#f92672">-</span><span style="color:#66d9ef">with</span><span style="color:#f92672">-</span>arg
</span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>
<h3 id="aks-8---ensure-that-persistent-volumes-in-storage-account-are-redundant-for-pods-with-stateful-applications">AKS-8 - Ensure that Persistent Volumes in storage account are redundant for Pods with stateful applications
  <a href="#aks-8---ensure-that-persistent-volumes-in-storage-account-are-redundant-for-pods-with-stateful-applications">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: Availability</strong></p>
<p><strong>Impact: Low</strong></p>
<p><strong>Guidance</strong></p>
<p>Data in an Azure Storage account is always replicated three times in the primary region. Azure Storage for Persistent Volumes offers other options for how your data is replicated in the primary or paired region:</p>
<ul>
<li>LRS synchronously replicates data 3 times in single physical location. It is least expensive replication but not recommended for apps with high availability and durability. LRS provides eleven 9 durability.</li>
<li>ZRS copies data synchronously across 3 availability zone in primary region. ZRS is recommended for apps requiring high availability across zones. ZRS provides twelve 9s durability.</li>
</ul>
<p>In AKS Premium_ZRS and StandardSSD_ZRS disk types are supported. ZRS disk could be scheduled on the zone or non-zone node, without the restriction that disk volume should be co-located in the same zone as a given node.</p>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://learn.microsoft.com/azure/aks/azure-disk-csi#azure-disk-csi-driver-features">Azure Disk CSI Driver</a></li>
<li><a href="https://learn.microsoft.com/azure/virtual-machines/disks-redundancy">Virtual Machine Disk Redundancy</a></li>
</ul>
<p><strong>Resource Graph Query</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_c8e45339d9" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_c8e45339d9">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_f8ad57f9af">
        Copy
        </button>
    </div>
    <div id="clipboard_f8ad57f9af">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> cannot<span style="color:#f92672">-</span>be<span style="color:#f92672">-</span>validated<span style="color:#f92672">-</span><span style="color:#66d9ef">with</span><span style="color:#f92672">-</span>arg
</span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>
<h3 id="aks-9---upgrade-persistent-volumes-with-deprecated-version-to-azure-csi-drivers">AKS-9 - Upgrade Persistent Volumes with deprecated version to Azure CSI drivers
  <a href="#aks-9---upgrade-persistent-volumes-with-deprecated-version-to-azure-csi-drivers">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: Storage</strong></p>
<p><strong>Impact: High</strong></p>
<p><strong>Guidance</strong></p>
<p>Starting with Kubernetes version 1.26, in-tree persistent volume types kubernetes.io/azure-disk and kubernetes.io/azure-file are deprecated and will no longer be supported. Removing these drivers following their deprecation is not planned, however you should migrate to the corresponding CSI drivers disks.csi.azure.com and file.csi.azure.com.</p>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/azure/aks/csi-storage-drivers">CSI Storage Drivers</a></li>
<li><a href="https://learn.microsoft.com/azure/aks/csi-migrate-in-tree-volumes">CSI Migrate in Tree Volumes</a></li>
</ul>
<p><strong>Resource Graph Query</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_c8e45339d9" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_c8e45339d9">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_f8ad57f9af">
        Copy
        </button>
    </div>
    <div id="clipboard_f8ad57f9af">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> cannot<span style="color:#f92672">-</span>be<span style="color:#f92672">-</span>validated<span style="color:#f92672">-</span><span style="color:#66d9ef">with</span><span style="color:#f92672">-</span>arg
</span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>
<h3 id="aks-10---implement-resource-quota-to-ensure-that-kubernetes-resources-do-not-exceed-hard-resource-limits">AKS-10 - Implement Resource Quota to ensure that Kubernetes resources do not exceed hard resource limits
  <a href="#aks-10---implement-resource-quota-to-ensure-that-kubernetes-resources-do-not-exceed-hard-resource-limits">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: System Efficiency</strong></p>
<p><strong>Impact: Low</strong></p>
<p><strong>Guidance</strong></p>
<p>A resource quota, defined by a ResourceQuota object, provides constraints that limit aggregate resource consumption per namespace. It can limit the quantity of objects that can be created in a namespace by type, as well as the total amount of compute resources that may be consumed by resources in that namespace.</p>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://kubernetes.io/docs/concepts/policy/resource-quotas/">Resource Quotas</a></li>
</ul>
<p><strong>Resource Graph Query</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_c8e45339d9" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_c8e45339d9">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_f8ad57f9af">
        Copy
        </button>
    </div>
    <div id="clipboard_f8ad57f9af">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> cannot<span style="color:#f92672">-</span>be<span style="color:#f92672">-</span>validated<span style="color:#f92672">-</span><span style="color:#66d9ef">with</span><span style="color:#f92672">-</span>arg
</span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>
<h3 id="aks-11---attach-virtual-nodes-aci-to-the-aks-cluster">AKS-11 - Attach Virtual Nodes (ACI) to the AKS cluster
  <a href="#aks-11---attach-virtual-nodes-aci-to-the-aks-cluster">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: System Efficiency</strong></p>
<p><strong>Impact: Low</strong></p>
<p><strong>Guidance</strong></p>
<p>To rapidly scale application workloads in an AKS cluster, you can use virtual nodes. With virtual nodes, pods provision much faster than through the Kubernetes cluster auto-scaler.</p>
<p>If the cluster has availability zones enabled, the following configuration changes need to be verified or established:</p>
<ul>
<li>Persistent Volumes - If the cluster is using persistent volumes backed by Azure Storage, ensure you have one nodepool per availability zone. Persistent volumes do not work across AZs and the auto-scaler could fail to create new pods if the nodepool cannot access the persistent volume.</li>
</ul>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://learn.microsoft.com/azure/aks/virtual-nodes">Virtual Nodes</a></li>
<li><a href="https://learn.microsoft.com/azure/container-instances/container-instances-overview">Azure Container Instances</a></li>
</ul>
<p><strong>Resource Graph Query</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_c8e45339d9" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_c8e45339d9">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_f8ad57f9af">
        Copy
        </button>
    </div>
    <div id="clipboard_f8ad57f9af">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> cannot<span style="color:#f92672">-</span>be<span style="color:#f92672">-</span>validated<span style="color:#f92672">-</span><span style="color:#66d9ef">with</span><span style="color:#f92672">-</span>arg
</span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>
<h3 id="aks-12---update-aks-tier-to-standard">AKS-12 - Update AKS tier to Standard
  <a href="#aks-12---update-aks-tier-to-standard">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: Availability</strong></p>
<p><strong>Impact: High</strong></p>
<p><strong>Guidance</strong></p>
<p>Production AKS clusters should be configured with the Standard tier. The AKS free service doesn&rsquo;t offer a financially backed SLA and node scalability is limited. To obtain that SLA, Standard tier must be selected.</p>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/azure/aks/free-standard-pricing-tiers">Pricing Tiers</a></li>
<li><a href="https://learn.microsoft.com/en-us/azure/architecture/reference-architectures/containers/aks/baseline-aks?toc=https%3A%2F%2Flearn.microsoft.com%2Fen-us%2Fazure%2Faks%2Ftoc.json&amp;bc=https%3A%2F%2Flearn.microsoft.com%2Fen-us%2Fazure%2Fbread%2Ftoc.json#kubernetes-api-server-sla">AKS Baseline Architecture</a></li>
</ul>
<p><strong>Resource Graph Query</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_985e80330a" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_985e80330a">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_83026f902f">
        Copy
        </button>
    </div>
    <div id="clipboard_83026f902f">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> Azure Resource Graph Query
</span></span><span style="display:flex;"><span><span style="color:#f92672">//</span> <span style="color:#66d9ef">Returns</span> <span style="color:#66d9ef">all</span> AKS clusters <span style="color:#66d9ef">not</span> running <span style="color:#66d9ef">on</span> the Standard tier
</span></span><span style="display:flex;"><span>resources
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> <span style="color:#66d9ef">type</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;microsoft.containerservice/managedclusters&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> sku.tier <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#34;Standard&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> project recommendationId<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;aks-12&#34;</span>, id, name, tags, param1<span style="color:#f92672">=</span>strcat(<span style="color:#e6db74">&#34;skuName: &#34;</span>, sku.name), param2<span style="color:#f92672">=</span>strcat(<span style="color:#e6db74">&#34;skuTier: &#34;</span>, sku.tier)
</span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>
<h3 id="aks-13---enable-aks-monitoring">AKS-13 - Enable AKS Monitoring
  <a href="#aks-13---enable-aks-monitoring">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: Monitoring</strong></p>
<p><strong>Impact: High</strong></p>
<p><strong>Guidance</strong></p>
<p>Azure Monitor collects events, captures container logs, collects CPU/Memory information from the Metrics API and allows the visualization of the data, to validate the near real time health and performance of AKS environments. The visualization tool can be Azure Monitor Container Insights, Prometheus, Grafana or others.</p>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://learn.microsoft.com/azure/aks/monitor-aks">Monitor AKS</a></li>
</ul>
<p><strong>Resource Graph Query</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_6dada6efe0" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_6dada6efe0">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_40da533a8f">
        Copy
        </button>
    </div>
    <div id="clipboard_40da533a8f">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> Azure Resource Graph Query
</span></span><span style="display:flex;"><span><span style="color:#f92672">//</span> <span style="color:#66d9ef">Returns</span> AKS clusters <span style="color:#66d9ef">where</span> either Azure Monitor <span style="color:#66d9ef">is</span> <span style="color:#66d9ef">not</span> enabled <span style="color:#66d9ef">and</span><span style="color:#f92672">/</span><span style="color:#66d9ef">or</span> Container Insights <span style="color:#66d9ef">is</span> <span style="color:#66d9ef">not</span> enabled
</span></span><span style="display:flex;"><span>resources
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>  <span style="color:#66d9ef">where</span> <span style="color:#66d9ef">type</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;microsoft.containerservice/managedclusters&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>  extend azureMonitor <span style="color:#f92672">=</span> tostring(parse_json(properties.azureMonitorProfile.metrics.enabled))
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>  extend insights <span style="color:#f92672">=</span> tostring(parse_json(properties.addonProfiles.omsagent.enabled))
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>  <span style="color:#66d9ef">where</span> isempty(azureMonitor) <span style="color:#66d9ef">or</span> isempty(insights)
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>  project recommendationId<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;aks-13&#34;</span>,id, name, tags, param1<span style="color:#f92672">=</span>strcat(<span style="color:#e6db74">&#34;azureMonitorProfileEnabled: &#34;</span>, iff(isempty(azureMonitor), <span style="color:#e6db74">&#34;false&#34;</span>, azureMonitor)), param2<span style="color:#f92672">=</span>strcat(<span style="color:#e6db74">&#34;containerInsightsEnabled: &#34;</span>, iff(isempty(insights), <span style="color:#e6db74">&#34;false&#34;</span>, insights))
</span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>
<h3 id="aks-14---use-ephemeral-disks-on-aks-clusters">AKS-14 - Use Ephemeral Disks on AKS clusters
  <a href="#aks-14---use-ephemeral-disks-on-aks-clusters">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: System Efficiency</strong></p>
<p><strong>Impact: Medium</strong></p>
<p><strong>Guidance</strong></p>
<p>Ephemeral OS disks provide lower read/write latency on the OS disk of AKS agent nodes since the disk is locally attached, and it is not replicated as managed disks. You will also get faster cluster operations like scale or upgrade thanks to faster re-imaging and boot times.</p>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://learn.microsoft.com/samples/azure-samples/aks-ephemeral-os-disk/aks-ephemeral-os-disk/">AKS Ephemeral OS Disk</a></li>
</ul>
<p><strong>Resource Graph Query</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_c8e45339d9" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_c8e45339d9">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_f8ad57f9af">
        Copy
        </button>
    </div>
    <div id="clipboard_f8ad57f9af">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> cannot<span style="color:#f92672">-</span>be<span style="color:#f92672">-</span>validated<span style="color:#f92672">-</span><span style="color:#66d9ef">with</span><span style="color:#f92672">-</span>arg
</span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>
<h3 id="aks-15---enable-and-remediate-azure-policies-configured-for-aks">AKS-15 - Enable and remediate Azure Policies configured for AKS
  <a href="#aks-15---enable-and-remediate-azure-policies-configured-for-aks">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: Governance</strong></p>
<p><strong>Impact: Low</strong></p>
<p><strong>Guidance</strong>
Azure Policies allow companies to enforce governance best practices in the AKS cluster around security, authentication, provisioning, networking and others.</p>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/azure/architecture/reference-architectures/containers/aks/baseline-aks?toc=https%3A%2F%2Flearn.microsoft.com%2Fen-us%2Fazure%2Faks%2Ftoc.json&amp;bc=https%3A%2F%2Flearn.microsoft.com%2Fen-us%2Fazure%2Fbread%2Ftoc.json#policy-management">AKS Baseline - Policy Management</a></li>
<li><a href="https://learn.microsoft.com/en-us/azure/aks/policy-reference">Built-in Policy Definitions for AKS</a></li>
</ul>
<p><strong>Resource Graph Query</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_c8e45339d9" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_c8e45339d9">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_f8ad57f9af">
        Copy
        </button>
    </div>
    <div id="clipboard_f8ad57f9af">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> cannot<span style="color:#f92672">-</span>be<span style="color:#f92672">-</span>validated<span style="color:#f92672">-</span><span style="color:#66d9ef">with</span><span style="color:#f92672">-</span>arg
</span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>
<h3 id="aks-16---enable-gitops-when-using-devops-frameworks">AKS-16 - Enable GitOps when using DevOps frameworks
  <a href="#aks-16---enable-gitops-when-using-devops-frameworks">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: Automation</strong></p>
<p><strong>Impact: Low</strong></p>
<p><strong>Guidance</strong></p>
<p>GitOps is an operating model for cloud-native applications that stores application and declarative infrastructure code in Git to be used as the source of truth for automated continuous delivery. With GitOps, you describe the desired state of your entire system in a git repository, and a GitOps operator deploys it to your environment, which is often a Kubernetes cluster. To prevent potential outages or unsuccessful failover scenarios, GitOps helps maintain the configuration of all AKS clusters to the intended configuration.</p>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/azure/architecture/guide/aks/aks-cicd-github-actions-and-gitops">GitOps with AKS</a></li>
<li><a href="https://learn.microsoft.com/en-us/azure/architecture/example-scenario/gitops-aks/gitops-blueprint-aks">GitOps for AKS - Reference Architecture</a></li>
</ul>
<p><strong>Resource Graph Query</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_f79d6bcffa" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_f79d6bcffa">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_64c84ec9e8">
        Copy
        </button>
    </div>
    <div id="clipboard_64c84ec9e8">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> Azure Resource Graph Query
</span></span><span style="display:flex;"><span><span style="color:#f92672">//</span> <span style="color:#66d9ef">Returns</span> AKS clusters <span style="color:#66d9ef">where</span> GitOps <span style="color:#66d9ef">is</span> <span style="color:#66d9ef">not</span> enabled
</span></span><span style="display:flex;"><span>resources
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>  <span style="color:#66d9ef">where</span> <span style="color:#66d9ef">type</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;microsoft.containerservice/managedclusters&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>  extend gitops <span style="color:#f92672">=</span> tostring (parse_json(properties.addOnProfiles.gitops.enabled))
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>  <span style="color:#66d9ef">where</span> isempty(gitops)
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span>  project recommendationId<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;aks-16&#34;</span>, id, name, tags, param1<span style="color:#f92672">=</span>strcat(<span style="color:#e6db74">&#34;gitopsEnabled: &#34;</span>, <span style="color:#e6db74">&#34;false&#34;</span>)
</span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>
<h3 id="aks-17---configure-affinity-or-anti-affinity-rules-based-on-application-requirements">AKS-17 - Configure affinity or anti-affinity rules based on application requirements
  <a href="#aks-17---configure-affinity-or-anti-affinity-rules-based-on-application-requirements">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: Availability</strong></p>
<p><strong>Impact: High</strong></p>
<p><strong>Guidance</strong></p>
<p>Configure Topology Spread Constraints to control how Pods are spread across your cluster among failure-domains such as regions, zones, nodes, and other user-defined topology domains. This can help to achieve high availability as well as efficient resource utilization.</p>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://kubernetes.io/docs/concepts/scheduling-eviction/topology-spread-constraints/">Topology Spread Constraints</a></li>
<li><a href="https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/">Assign Pod Node</a></li>
</ul>
<p><strong>Resource Graph Query</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_c8e45339d9" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_c8e45339d9">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_f8ad57f9af">
        Copy
        </button>
    </div>
    <div id="clipboard_f8ad57f9af">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> cannot<span style="color:#f92672">-</span>be<span style="color:#f92672">-</span>validated<span style="color:#f92672">-</span><span style="color:#66d9ef">with</span><span style="color:#f92672">-</span>arg
</span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>
<h3 id="aks-18---configures-pods-liveness-readiness-and-startup-probes">AKS-18 - Configures Pods Liveness, Readiness, and Startup Probes
  <a href="#aks-18---configures-pods-liveness-readiness-and-startup-probes">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: Availability</strong></p>
<p><strong>Impact: High</strong></p>
<p><strong>Guidance</strong></p>
<p>AKS kubelet controller uses liveness probes to validate containers and applications health. Based on containers health, kubelet will know when to restart a container.</p>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://kubernetes.io/docs/tasks/configure-pod-container/configure-liveness-readiness-startup-probes/">Configure probes</a></li>
<li><a href="https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/">Assign Pod Node</a></li>
</ul>
<p><strong>Resource Graph Query</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_c8e45339d9" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_c8e45339d9">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_f8ad57f9af">
        Copy
        </button>
    </div>
    <div id="clipboard_f8ad57f9af">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> cannot<span style="color:#f92672">-</span>be<span style="color:#f92672">-</span>validated<span style="color:#f92672">-</span><span style="color:#66d9ef">with</span><span style="color:#f92672">-</span>arg
</span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>
<h3 id="aks-19---configure-pod-replica-sets-in-production-applications-to-guarantee-availability">AKS-19 - Configure pod replica sets in production applications to guarantee availability
  <a href="#aks-19---configure-pod-replica-sets-in-production-applications-to-guarantee-availability">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: Availability</strong></p>
<p><strong>Impact: High</strong></p>
<p><strong>Guidance</strong></p>
<p>Configure ReplicaSets in the Pod or Deployment manifests to maintain a stable set of replica Pods running at any given time. This feature will guarantee the availability of a specified number of identical Pods.</p>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://kubernetes.io/docs/concepts/workloads/controllers/replicaset/">Replica Sets</a></li>
</ul>
<p><strong>Resource Graph Query</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_c8e45339d9" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_c8e45339d9">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_f8ad57f9af">
        Copy
        </button>
    </div>
    <div id="clipboard_f8ad57f9af">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> cannot<span style="color:#f92672">-</span>be<span style="color:#f92672">-</span>validated<span style="color:#f92672">-</span><span style="color:#66d9ef">with</span><span style="color:#f92672">-</span>arg
</span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>
<h3 id="aks-20---configure-system-nodepool-count">AKS-20 - Configure system nodepool count
  <a href="#aks-20---configure-system-nodepool-count">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: Availability</strong></p>
<p><strong>Impact: High</strong></p>
<p><strong>Guidance</strong></p>
<p>The system node pool should be configured with a minimum node count of two to ensure critical system pods are resilient to node outages.</p>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://learn.microsoft.com/azure/aks/use-system-pools?tabs=azure-cli">System nodepools</a></li>
</ul>
<p><strong>Resource Graph Query</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_d8d0289298" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_d8d0289298">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_ed02c62a2b">
        Copy
        </button>
    </div>
    <div id="clipboard_ed02c62a2b">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> Azure Resource Graph Query
</span></span><span style="display:flex;"><span><span style="color:#f92672">//</span> <span style="color:#66d9ef">Returns</span> <span style="color:#66d9ef">each</span> AKS <span style="color:#66d9ef">cluster</span> <span style="color:#66d9ef">with</span> nodepools that have <span style="color:#66d9ef">system</span> nodepools <span style="color:#66d9ef">with</span> <span style="color:#66d9ef">less</span> <span style="color:#66d9ef">than</span> <span style="color:#ae81ff">2</span> nodes
</span></span><span style="display:flex;"><span>resources
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> <span style="color:#66d9ef">type</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;microsoft.containerservice/managedclusters&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> mv<span style="color:#f92672">-</span>expand agentPoolProfile <span style="color:#f92672">=</span> properties.agentPoolProfiles
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> extend taints <span style="color:#f92672">=</span> tostring(parse_json(agentPoolProfile.nodeTaints))
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> extend nodePool <span style="color:#f92672">=</span> tostring(parse_json(agentPoolProfile.name))
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> taints has <span style="color:#e6db74">&#34;CriticalAddonsOnly=true:NoSchedule&#34;</span> <span style="color:#66d9ef">and</span>  agentPoolProfile.minCount <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> project recommendationid<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;aks-20&#34;</span>, id, name, param1<span style="color:#f92672">=</span>strcat(<span style="color:#e6db74">&#34;nodePoolName: &#34;</span>, nodePool), param2<span style="color:#f92672">=</span>strcat(<span style="color:#e6db74">&#34;nodePoolMinNodeCount: &#34;</span>, agentPoolProfile.minCount)
</span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>
<h3 id="aks-21---configure-user-nodepool-count">AKS-21 - Configure user nodepool count
  <a href="#aks-21---configure-user-nodepool-count">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: Availability</strong></p>
<p><strong>Impact: High</strong></p>
<p><strong>Guidance</strong></p>
<p>The user node pool should be configured with a minimum node count of two if the application requires high availability.</p>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://learn.microsoft.com/azure/well-architected/service-guides/azure-kubernetes-service#design-checklist">Azure Well-Architected Framework review for Azure Kubernetes Service (AKS)</a></li>
</ul>
<p><strong>Resource Graph Query</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_eb163de235" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_eb163de235">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_48ec159148">
        Copy
        </button>
    </div>
    <div id="clipboard_48ec159148">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> Azure Resource Graph Query
</span></span><span style="display:flex;"><span><span style="color:#f92672">//</span> <span style="color:#66d9ef">Returns</span> <span style="color:#66d9ef">each</span> AKS <span style="color:#66d9ef">cluster</span> <span style="color:#66d9ef">with</span> nodepools that have <span style="color:#66d9ef">user</span> nodepools <span style="color:#66d9ef">with</span> <span style="color:#66d9ef">less</span> <span style="color:#66d9ef">than</span> <span style="color:#ae81ff">2</span> nodes
</span></span><span style="display:flex;"><span>resources
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> <span style="color:#66d9ef">type</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;microsoft.containerservice/managedclusters&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> mv<span style="color:#f92672">-</span>expand agentPoolProfile <span style="color:#f92672">=</span> properties.agentPoolProfiles
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> extend taints <span style="color:#f92672">=</span> tostring(parse_json(agentPoolProfile.nodeTaints))
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> extend nodePool <span style="color:#f92672">=</span> tostring(parse_json(agentPoolProfile.name))
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> taints <span style="color:#f92672">!</span>has <span style="color:#e6db74">&#34;CriticalAddonsOnly=true:NoSchedule&#34;</span> <span style="color:#66d9ef">and</span>  agentPoolProfile.minCount <span style="color:#f92672">&lt;</span> <span style="color:#ae81ff">2</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> project recommendationid<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;aks-21&#34;</span>, id, name, param1<span style="color:#f92672">=</span>strcat(<span style="color:#e6db74">&#34;nodePoolName: &#34;</span>, nodePool), param2<span style="color:#f92672">=</span>strcat(<span style="color:#e6db74">&#34;nodePoolMinNodeCount: &#34;</span>, agentPoolProfile.minCount)
</span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>
<h3 id="aks-22---configure-pod-disruption-budgets-pdbs">AKS-22 - Configure pod disruption budgets (PDBs)
  <a href="#aks-22---configure-pod-disruption-budgets-pdbs">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: Availability</strong></p>
<p><strong>Impact: Medium</strong></p>
<p><strong>Guidance</strong></p>
<p>A Pod Disruption Budget (PDB) is a Kubernetes resource that allows you to configure the minimum number or percentage of pods that should remain available during voluntary disruptions, such as maintenance or scaling events. To maintain the availability of applications, define Pod Disruption Budgets (PDBs) to make sure that a minimum number of pods are available in the cluster.</p>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://kubernetes.io/docs/tasks/run-application/configure-pdb/">Configure PDBs</a></li>
<li><a href="https://learn.microsoft.com/azure/aks/operator-best-practices-scheduler#plan-for-availability-using-pod-disruption-budgets">Plan availability using PDBs</a></li>
</ul>
<p><strong>Resource Graph Query</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_c8e45339d9" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_c8e45339d9">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_f8ad57f9af">
        Copy
        </button>
    </div>
    <div id="clipboard_f8ad57f9af">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> cannot<span style="color:#f92672">-</span>be<span style="color:#f92672">-</span>validated<span style="color:#f92672">-</span><span style="color:#66d9ef">with</span><span style="color:#f92672">-</span>arg
</span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>
<h3 id="aks-23---nodepool-subnet-size-needs-to-accommodate-maximum-auto-scale-settings">AKS-23 - Nodepool subnet size needs to accommodate maximum auto-scale settings
  <a href="#aks-23---nodepool-subnet-size-needs-to-accommodate-maximum-auto-scale-settings">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: Availability</strong></p>
<p><strong>Impact: High</strong></p>
<p><strong>Guidance</strong></p>
<p>Nodepool subnets should be sized to accommodate maximum auto-scale settings. By properly sizing the subnet, AKS can efficiently scale out nodes to meet increased demand, reducing the risk of resource constraints and potential service disruptions.</p>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://learn.microsoft.com/azure/aks/concepts-network">AKS Networking</a></li>
</ul>
<p><strong>Resource Graph Query</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_c8e45339d9" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_c8e45339d9">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_f8ad57f9af">
        Copy
        </button>
    </div>
    <div id="clipboard_f8ad57f9af">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> cannot<span style="color:#f92672">-</span>be<span style="color:#f92672">-</span>validated<span style="color:#f92672">-</span><span style="color:#66d9ef">with</span><span style="color:#f92672">-</span>arg
</span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>
<h3 id="aks-24---enforce-resource-quotas-at-the-namespace-level">AKS-24 - Enforce resource quotas at the namespace level
  <a href="#aks-24---enforce-resource-quotas-at-the-namespace-level">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: Availability</strong></p>
<p><strong>Impact: High</strong></p>
<p><strong>Guidance</strong></p>
<p>Enforcing namespace-level resource quotas is crucial for ensuring reliability by preventing resource exhaustion and maintaining cluster stability. This helps prevent individual applications or users from monopolizing resources, which can lead to degraded performance or outages for other applications in the cluster.</p>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://learn.microsoft.com/azure/aks/operator-best-practices-scheduler#enforce-resource-quotas">Resource quotas</a></li>
</ul>
<p><strong>Resource Graph Query</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_c8e45339d9" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_c8e45339d9">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_f8ad57f9af">
        Copy
        </button>
    </div>
    <div id="clipboard_f8ad57f9af">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> cannot<span style="color:#f92672">-</span>be<span style="color:#f92672">-</span>validated<span style="color:#f92672">-</span><span style="color:#66d9ef">with</span><span style="color:#f92672">-</span>arg
</span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>


    



          <div class="row"></div> 

        </div>

      </div> 

    </div> 
<script src="http://localhost:1313/Azure-Proactive-Resiliency-Library/lib/jquery.min.js"></script> 
<script src="http://localhost:1313/Azure-Proactive-Resiliency-Library/lib/popper.min.js"></script> 

<script src="http://localhost:1313/Azure-Proactive-Resiliency-Library/js/bootstrap.min.js"></script> 


<script type="text/javascript" src="/Azure-Proactive-Resiliency-Library/plugins/lunr.min.js"></script>
<script type="text/javascript" src="/Azure-Proactive-Resiliency-Library/plugins/auto-complete.js"></script>
<link href="/Azure-Proactive-Resiliency-Library/plugins/auto-complete.css" rel="stylesheet">
<script type="text/javascript">
  
      var baseurl = "http:\/\/localhost:1313\/Azure-Proactive-Resiliency-Library\/";
  
</script>
<script type="text/javascript" src="/Azure-Proactive-Resiliency-Library/plugins/search.js"></script>

<script type="text/javascript" src="/Azure-Proactive-Resiliency-Library/plugins/favorites.js"></script>


<script type="text/javascript" src="/Azure-Proactive-Resiliency-Library/plugins/clipboard.js"></script>
<script>
  new ClipboardJS('.btn');
</script>
</body>

</html>
