<!DOCTYPE html>
<html><head><script src="/Azure-Proactive-Resiliency-Library/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=Azure-Proactive-Resiliency-Library/livereload" data-no-instant defer></script>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    
    <meta name="description" content="Best practices and resiliency recommendations for Azure VMware Solution and associated resources and settings.">
    
    <link rel="alternate" type="application/rss+xml" href="http://localhost:1313/Azure-Proactive-Resiliency-Library/services/specialized-workloads/azure-vmware-solution/index.xml" title="Azure Proactive Resiliency Library (APRL)" />
    <link rel="canonical" href="http://localhost:1313/Azure-Proactive-Resiliency-Library/services/specialized-workloads/azure-vmware-solution/">

    <title>
        
        Azure VMware Solution | Azure Proactive Resiliency Library (APRL)
        
    </title>

    
    <link href="http://localhost:1313/Azure-Proactive-Resiliency-Library/css/fontawesome.min.css" rel="stylesheet">

    
    <link rel="stylesheet" href="http://localhost:1313/Azure-Proactive-Resiliency-Library/css/ace.min.css">

    

    
    

  
  <script type="text/javascript">
    (function(c,l,a,r,i,t,y){
        c[a]=c[a]||function(){(c[a].q=c[a].q||[]).push(arguments)};
        t=l.createElement(r);t.async=1;t.src="https://www.clarity.ms/tag/"+i;
        y=l.getElementsByTagName(r)[0];y.parentNode.insertBefore(t,y);
    })(window, document, "clarity", "script", "kxpusfirv0");
  </script>

  
</head>
<body>

  <script src="https://unpkg.com/vanilla-back-to-top@7.2.1/dist/vanilla-back-to-top.min.js"></script>
  <script>addBackToTop({
      diameter: 75,
      backgroundColor: 'rgb(0, 123, 255)',
      textColor: '#ffffff',
      cornerOffset: 25,
      scrollDuration: 300
    })</script><nav class="navbar navbar-expand-lg navbar-dark bg-primary shadow sticky-top" id="navbarMain">
    <div class="container">
        <div>
            <a class="navbar-brand" href="/Azure-Proactive-Resiliency-Library">
                
                    <img src="/Azure-Proactive-Resiliency-Library/media/img/aprl-white.png" />
                
                Azure Proactive Resiliency Library (APRL)
            </a>
        </div>
        
            <button class="navbar-toggler navbar-toggler-right collapsed" type="button" data-toggle="collapse" data-target="#navbarMainCollapse" aria-controls="navbarMainCollapse" aria-expanded="false" aria-label="Toggle navigation">
              <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse" id="navbarMainCollapse">
              <ul class="navbar-nav ml-auto">
                            <li class="nav-item">
                                <a class="nav-link" href="https://aka.ms/waf" target="_blank">
                                  Well-Architected Framework
                                </a>
                            </li>
                            <li class="nav-item">
                                <a class="nav-link" href="https://aka.ms/aprl/repo" target="_blank">
                                  Source Code <i class='fab fa-github'></i>
                                </a>
                            </li>
              </ul>
            </div>
    </div>
    
    
</nav>
<div class="container-fluid">
    <div class="row">

      <div class="docs-sidenav order-0 col-12 col-md-3 col-lg-2 col-xl-2 position-sticky border-right"><nav class="navbar navbar-expand-md navbar-light pl-0">
    <button class="navbar-toggler navbar-toggler-right collapsed" type="button" data-toggle="collapse" data-target="#sidenav-left-collapse" aria-controls="sidenav-left-collapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

     <div class="collapse navbar-collapse align-items-start flex-column" id="sidenav-left-collapse">
            <form class="form-inline my-2 my-lg-0 searchbox">
                <input class="form-control mr-sm-2 w-100" data-search-input id="search-by" type="text" placeholder="Search">
            </form>

        

         <ul class="navbar-nav flex-column pt-3">
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/" class="nav-item my-1 parent haschildren
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/"><h6>Azure Services</h6></a>
        
        <ul class="list-unstyled ml-2">
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/ai-ml/" class="nav-item my-1 haschildren
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/ai-ml/"><h6>AI and ML</h6></a>
        
        <ul class="list-unstyled ml-2">
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/ai-ml/databricks/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/ai-ml/databricks/"><h6>Azure Databricks</h6></a>
        
    </li>
        </ul>
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/batch/" class="nav-item my-1 haschildren
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/batch/"><h6>Batch</h6></a>
        
        <ul class="list-unstyled ml-2">
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/batch/batch-accounts/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/batch/batch-accounts/"><h6>Batch Accounts</h6></a>
        
    </li>
        </ul>
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/compute/" class="nav-item my-1 haschildren
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/compute/"><h6>Compute</h6></a>
        
        <ul class="list-unstyled ml-2">
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/compute/site-recovery/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/compute/site-recovery/"><h6>Azure Site Recovery</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/compute/compute-gallery/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/compute/compute-gallery/"><h6>Compute Gallery</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/compute/image-templates/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/compute/image-templates/"><h6>Image Templates</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/compute/virtual-machine-scale-sets/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/compute/virtual-machine-scale-sets/"><h6>Virtual Machine Scale Sets</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/compute/virtual-machines/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/compute/virtual-machines/"><h6>Virtual Machines</h6></a>
        
    </li>
        </ul>
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/container/" class="nav-item my-1 haschildren
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/container/"><h6>Containers</h6></a>
        
        <ul class="list-unstyled ml-2">
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/container/aks/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/container/aks/"><h6>AKS</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/container/container-registry/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/container/container-registry/"><h6>Container Registry</h6></a>
        
    </li>
        </ul>
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/database/" class="nav-item my-1 haschildren
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/database/"><h6>Databases</h6></a>
        
        <ul class="list-unstyled ml-2">
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/database/sqldb/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/database/sqldb/"><h6>SQL DB</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/database/cosmosdb/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/database/cosmosdb/"><h6>Cosmos DB</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/database/db-for-mysql/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/database/db-for-mysql/"><h6>DB for MySQL</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/database/db-for-postgresql/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/database/db-for-postgresql/"><h6>DB for PostgreSQL</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/database/redis-cache/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/database/redis-cache/"><h6>Redis Cache</h6></a>
        
    </li>
        </ul>
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/general/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/general/"><h6>General</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/hybrid/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/hybrid/"><h6>Hybrid</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/integration/" class="nav-item my-1 haschildren
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/integration/"><h6>Integration</h6></a>
        
        <ul class="list-unstyled ml-2">
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/integration/api-management/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/integration/api-management/"><h6>Api Management</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/integration/event-grid/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/integration/event-grid/"><h6>Event Grid</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/integration/event-hub/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/integration/event-hub/"><h6>Event Hub</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/integration/service-bus/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/integration/service-bus/"><h6>Service Bus</h6></a>
        
    </li>
        </ul>
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/iot/" class="nav-item my-1 haschildren
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/iot/"><h6>Internet of Things</h6></a>
        
        <ul class="list-unstyled ml-2">
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/iot/iot-hub/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/iot/iot-hub/"><h6>IoT Hub</h6></a>
        
    </li>
        </ul>
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/management/" class="nav-item my-1 haschildren
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/management/"><h6>Management</h6></a>
        
        <ul class="list-unstyled ml-2">
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/management/automation-account/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/management/automation-account/"><h6>Automation Account</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/management/management-group/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/management/management-group/"><h6>Management Groups</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/management/resource-group/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/management/resource-group/"><h6>Resource Groups</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/management/subscription/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/management/subscription/"><h6>Subscription</h6></a>
        
    </li>
        </ul>
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/migration/" class="nav-item my-1 haschildren
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/migration/"><h6>Migration</h6></a>
        
        <ul class="list-unstyled ml-2">
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/migration/azure-backup/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/migration/azure-backup/"><h6>Azure Backup</h6></a>
        
    </li>
        </ul>
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/monitoring/" class="nav-item my-1 haschildren
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/monitoring/"><h6>Monitoring</h6></a>
        
        <ul class="list-unstyled ml-2">
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/monitoring/application-insights/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/monitoring/application-insights/"><h6>Application Insights</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/monitoring/log-analytics/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/monitoring/log-analytics/"><h6>Log Analytics</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/monitoring/resource-health-alerts/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/monitoring/resource-health-alerts/"><h6>Resource Health Alerts</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/monitoring/service-health-alerts/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/monitoring/service-health-alerts/"><h6>Service Health Alerts</h6></a>
        
    </li>
        </ul>
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/networking/" class="nav-item my-1 haschildren
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/networking/"><h6>Networking</h6></a>
        
        <ul class="list-unstyled ml-2">
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/networking/application-gateway/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/networking/application-gateway/"><h6>Application Gateway</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/networking/ddos-protection-plans/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/networking/ddos-protection-plans/"><h6>DDoS Protection Plans</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/networking/expressroute-circuits/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/networking/expressroute-circuits/"><h6>ExpressRoute Circuits</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/networking/expressroute-connection/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/networking/expressroute-connection/"><h6>ExpressRoute Connection</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/networking/expressroute-direct/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/networking/expressroute-direct/"><h6>ExpressRoute Direct</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/networking/expressroute-gateway/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/networking/expressroute-gateway/"><h6>ExpressRoute Gateway</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/networking/expressroute-traffic-collector/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/networking/expressroute-traffic-collector/"><h6>ExpressRoute Traffic Collector</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/networking/firewall/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/networking/firewall/"><h6>Firewall</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/networking/front-door/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/networking/front-door/"><h6>Front Door</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/networking/load-balancer/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/networking/load-balancer/"><h6>Load Balancer</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/networking/network-security-group/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/networking/network-security-group/"><h6>Network Security Group</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/networking/network-watcher/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/networking/network-watcher/"><h6>Network Watcher</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/networking/private-dns-zones/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/networking/private-dns-zones/"><h6>Private DNS Zones</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/networking/private-endpoints/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/networking/private-endpoints/"><h6>Private Endpoints</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/networking/public-ip/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/networking/public-ip/"><h6>Public Ip</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/networking/route-table/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/networking/route-table/"><h6>Route Table</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/networking/traffic-manager/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/networking/traffic-manager/"><h6>Traffic Manager</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/networking/virtual-networks/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/networking/virtual-networks/"><h6>Virtual Networks</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/networking/vpn-gateway/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/networking/vpn-gateway/"><h6>VPN Gateway</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/networking/web-application-firewall/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/networking/web-application-firewall/"><h6>Web Application Firewall</h6></a>
        
    </li>
        </ul>
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/security/" class="nav-item my-1 haschildren
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/security/"><h6>Security</h6></a>
        
        <ul class="list-unstyled ml-2">
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/security/key-vault/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/security/key-vault/"><h6>Key Vault</h6></a>
        
    </li>
        </ul>
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/specialized-workloads/" class="nav-item my-1 parent haschildren
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/specialized-workloads/"><h6>Specialized Workloads</h6></a>
        
        <ul class="list-unstyled ml-2">
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/specialized-workloads/azure-hpc/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/specialized-workloads/azure-hpc/"><h6>Azure High Performance Computing</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/specialized-workloads/azure-virtual-desktop/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/specialized-workloads/azure-virtual-desktop/"><h6>Azure Virtual Desktop</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/specialized-workloads/azure-vmware-solution/" class="nav-item my-1 active
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/specialized-workloads/azure-vmware-solution/"><h6>Azure VMware Solution</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/specialized-workloads/sap-on-azure/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/specialized-workloads/sap-on-azure/"><h6>SAP on Azure</h6></a>
        
    </li>
        </ul>
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/storage/" class="nav-item my-1 haschildren
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/storage/"><h6>Storage</h6></a>
        
        <ul class="list-unstyled ml-2">
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/storage/azure-netapp-files/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/storage/azure-netapp-files/"><h6>Azure NetApp Files</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/storage/storage-account/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/storage/storage-account/"><h6>Storage Accounts (Blob/Azure Data Lake Storage Gen2)</h6></a>
        
    </li>
        </ul>
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/web/" class="nav-item my-1 haschildren
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/web/"><h6>Web</h6></a>
        
        <ul class="list-unstyled ml-2">
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/web/app-service-plan/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/web/app-service-plan/"><h6>App Service Plan</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/web/signalr/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/web/signalr/"><h6>SignalR</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/services/web/web-app/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/services/web/web-app/"><h6>Web App</h6></a>
        
    </li>
        </ul>
    </li>
        </ul>
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/well-architected/" class="nav-item my-1 haschildren
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/well-architected/"><h6>Well Architected Framework</h6></a>
        
        <ul class="list-unstyled ml-2">
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/well-architected/1-define/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/well-architected/1-define/"><h6>1 - Define</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/well-architected/2-design/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/well-architected/2-design/"><h6>2 - Design</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/well-architected/3-test/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/well-architected/3-test/"><h6>3 - Test</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/well-architected/4-deploy/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/well-architected/4-deploy/"><h6>4 - Deploy</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/well-architected/5-monitor/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/well-architected/5-monitor/"><h6>5 - Monitor</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/well-architected/6-respond/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/well-architected/6-respond/"><h6>6 - Respond</h6></a>
        
    </li>
        </ul>
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/contributing/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/contributing/"><h6>Contributing</h6></a>
        
    </li>
    <li data-nav-id="/Azure-Proactive-Resiliency-Library/privacy/" class="nav-item my-1
        ">
        
        
          <a class="nav-link p-0" href="/Azure-Proactive-Resiliency-Library/privacy/"><h6>Privacy</h6></a>
        
    </li>
        </ul>
    </div>
</nav>


</div>
        <div class="main col-12 order-1 col-md-9 col-lg-10 col-xl-10 py-3">
          

<div class="d-flex flex-column">
    <h1 class="js-title">Azure VMware Solution</h1>
    <div class="d-flex align-items-center">
        
    </div>
</div>

<hr>


<p>The presented resiliency recommendations in this guidance include Azure VMware Solution and associated resources and settings.</p>
<h2 id="summary-of-recommendations">Summary of Recommendations
  <a href="#summary-of-recommendations">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h2>

<div class="table table-striped" role="alert">
    <table>
<thead>
<tr>
<th style="text-align:left">Recommendation</th>
<th style="text-align:center">Category</th>
<th style="text-align:center">Impact</th>
<th style="text-align:center">State</th>
<th style="text-align:center">ARG Query Available</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left"><a href="#avs-1---configure-azure-service-health-notifications-and-alerts-for-azure-vmware-solution">AVS-1 Configure Azure Service Health notifications and alerts for Azure VMware Solution</a></td>
<td style="text-align:center">Monitoring</td>
<td style="text-align:center">High</td>
<td style="text-align:center">Verified</td>
<td style="text-align:center">Yes</td>
</tr>
<tr>
<td style="text-align:left"><a href="#avs-2---configure-syslog-in-diagnostic-settings-for-azure-vmware-solution">AVS-2 Configure Syslog in Diagnostic Settings for Azure VMware Solution</a></td>
<td style="text-align:center">Monitoring</td>
<td style="text-align:center">Medium</td>
<td style="text-align:center">Verified</td>
<td style="text-align:center">Yes</td>
</tr>
<tr>
<td style="text-align:left"><a href="#avs-3---configure-azure-monitor-alert-warning-thresholds-for-vsan-datastore-utilization">AVS-3 Configure Azure Monitor Alert warning thresholds for vSAN datastore utilization</a></td>
<td style="text-align:center">Monitoring</td>
<td style="text-align:center">High</td>
<td style="text-align:center">Verified</td>
<td style="text-align:center">No</td>
</tr>
<tr>
<td style="text-align:left"><a href="#avs-4---enable-stretched-clusters-for-multi-az-availability-of-the-vsan-datastore">AVS-4 Enable Stretched Clusters for Multi-AZ Availability of the vSAN Datastore</a></td>
<td style="text-align:center">Availability</td>
<td style="text-align:center">Low</td>
<td style="text-align:center">Verified</td>
<td style="text-align:center">Yes</td>
</tr>
<tr>
<td style="text-align:left"><a href="#avs-5---monitor-cpu-utilization-to-ensure-sufficient-resources-for-workloads">AVS-5 Monitor CPU Utilization to ensure sufficient resources for workloads</a></td>
<td style="text-align:center">Monitoring</td>
<td style="text-align:center">Medium</td>
<td style="text-align:center">Verified</td>
<td style="text-align:center">Yes</td>
</tr>
<tr>
<td style="text-align:left"><a href="#avs-6---monitor-memory-utilization-to-ensure-sufficient-resources-for-workloads">AVS-6 Monitor Memory Utilization to ensure sufficient resources for workloads</a></td>
<td style="text-align:center">Monitoring</td>
<td style="text-align:center">Medium</td>
<td style="text-align:center">Verified</td>
<td style="text-align:center">Yes</td>
</tr>
<tr>
<td style="text-align:left"><a href="#avs-7---monitor-when-azure-vmware-solution-cluster-size-is-approaching-the-host-limit">AVS-7 Monitor when Azure VMware Solution Cluster Size is approaching the host limit</a></td>
<td style="text-align:center">Monitoring</td>
<td style="text-align:center">Medium</td>
<td style="text-align:center">Verified</td>
<td style="text-align:center">No</td>
</tr>
<tr>
<td style="text-align:left"><a href="#avs-8---monitor-when-azure-vmware-solution-private-cloud-is-reaching-the-capacity-limit">AVS-8 Monitor when Azure VMware Solution Private Cloud is reaching the capacity limit</a></td>
<td style="text-align:center">Monitoring</td>
<td style="text-align:center">Medium</td>
<td style="text-align:center">Verified</td>
<td style="text-align:center">No</td>
</tr>
<tr>
<td style="text-align:left"><a href="#avs-9---apply-resource-delete-lock-on-the-resource-group-hosting-the-private-cloud">AVS-9 Apply Resource delete lock on the resource group hosting the private cloud</a></td>
<td style="text-align:center">Governance</td>
<td style="text-align:center">High</td>
<td style="text-align:center">Verified</td>
<td style="text-align:center">No</td>
</tr>
<tr>
<td style="text-align:left"><a href="#avs-10---align-expressroute-configuration-with-best-practices-for-circuit-resilience">AVS-10 Align ExpressRoute configuration with best practices for circuit resilience</a></td>
<td style="text-align:center">Networking</td>
<td style="text-align:center">High</td>
<td style="text-align:center">Preview</td>
<td style="text-align:center">No</td>
</tr>
<tr>
<td style="text-align:left"><a href="#avs-11---deploy-two-or-more-circuits-in-different-peering-locations-when-using-stretched-clusters">AVS-11 Deploy two or more circuits in different peering locations when using stretched clusters</a></td>
<td style="text-align:center">Networking</td>
<td style="text-align:center">High</td>
<td style="text-align:center">Preview</td>
<td style="text-align:center">No</td>
</tr>
<tr>
<td style="text-align:left"><a href="#avs-12---deploy-two-azure-vmware-solution-private-clouds-in-different-regions-for-geographical-disaster-recovery">AVS-12 Deploy two Azure VMware Solution private clouds in different regions for geographical disaster recovery</a></td>
<td style="text-align:center">Disaster Recovery</td>
<td style="text-align:center">High</td>
<td style="text-align:center">Preview</td>
<td style="text-align:center">No</td>
</tr>
<tr>
<td style="text-align:left"><a href="#avs-13---use-the-avs-interconnect-feature-to-connect-private-clouds-in-different-availability-zones">AVS-13 Use the AVS Interconnect feature to connect private clouds in different availability zones</a></td>
<td style="text-align:center">Storage</td>
<td style="text-align:center">High</td>
<td style="text-align:center">Preview</td>
<td style="text-align:center">No</td>
</tr>
<tr>
<td style="text-align:left"><a href="#avs-14---use-key-autorotation-for-vsan-datastore-customer-managed-keys">AVS-14 Use key autorotation for vSAN datastore customer-managed keys</a></td>
<td style="text-align:center">Storage</td>
<td style="text-align:center">High</td>
<td style="text-align:center">Preview</td>
<td style="text-align:center">No</td>
</tr>
<tr>
<td style="text-align:left"><a href="#avs-15---configure-ldaps-identity-integration-with-two-sources-for-nsx-and-vcenter-server-management-consoles">AVS-15 Configure LDAPS Identity integration with two sources for NSX and vCenter Server management consoles</a></td>
<td style="text-align:center">Storage</td>
<td style="text-align:center">High</td>
<td style="text-align:center">Preview</td>
<td style="text-align:center">No</td>
</tr>
<tr>
<td style="text-align:left"><a href="#avs-16---use-hcx-network-extension-high-availability">AVS-16 Use HCX Network Extension High Availability</a></td>
<td style="text-align:center">Availability</td>
<td style="text-align:center">High</td>
<td style="text-align:center">Preview</td>
<td style="text-align:center">No</td>
</tr>
<tr>
<td style="text-align:left"><a href="#avs-17---verify-management-networks-are-not-extended-with-hcx-network-extension">AVS-17 Verify Management Networks are not extended with HCX Network Extension</a></td>
<td style="text-align:center">Networking</td>
<td style="text-align:center">High</td>
<td style="text-align:center">Preview</td>
<td style="text-align:center">No</td>
</tr>
<tr>
<td style="text-align:left"><a href="#avs-18---use-multiple-dns-servers-per-private-fqdn-zone">AVS-18 Use multiple DNS servers per private FQDN zone</a></td>
<td style="text-align:center">Networking</td>
<td style="text-align:center">High</td>
<td style="text-align:center">Preview</td>
<td style="text-align:center">No</td>
</tr>
<tr>
<td style="text-align:left"><a href="#avs-19---verify-vsan-ftt-configuration-aligns-with-the-cluster-size">AVS-19 Verify vSAN FTT configuration aligns with the cluster size</a></td>
<td style="text-align:center">Application Resilience</td>
<td style="text-align:center">High</td>
<td style="text-align:center">Preview</td>
<td style="text-align:center">No</td>
</tr>
</tbody>
</table>

</div>


<div class="alert alert-info" role="alert">
    Definitions of states can be found <a href="http://localhost:1313/Azure-Proactive-Resiliency-Library/#definitions-of-terms-used-in-aprl">here</a>
</div>

<h2 id="recommendations-details">Recommendations Details
  <a href="#recommendations-details">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h2>
<h3 id="avs-1---configure-azure-service-health-notifications-and-alerts-for-azure-vmware-solution">AVS-1 - Configure Azure Service Health notifications and alerts for Azure VMware Solution
  <a href="#avs-1---configure-azure-service-health-notifications-and-alerts-for-azure-vmware-solution">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: Monitoring</strong></p>
<p><strong>Impact: Medium</strong></p>
<p><strong>Recommendation/Guidance</strong></p>
<p>Ensure Azure Service Health notifications and alerts are configured for the Azure VMware Solution service in the subscriptions and regions where Azure VMware Solution is deployed.</p>
<p>Azure Service Health is the mechanism used to inform customers of any service or security issues affecting their private cloud deployment. Additionally, Azure Service Health is used to inform customers of maintenance activities in their Azure VMware Solution environments including host replacements, upgrades, and any service updates which could potentially impact customer operations. Proper configuration of Azure Service Health notifications and alerts ensures that customers receive relevant notifications and can reduce service request submissions due to Azure VMware Solution maintenance.</p>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/scenarios/azure-vmware/eslz-management-and-monitoring#design-recommendations">Learn More</a></li>
</ul>
<p><strong>Resource Graph Query</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_d6bf99ddc6" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_d6bf99ddc6">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_972738bb65">
        Copy
        </button>
    </div>
    <div id="clipboard_972738bb65">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> Azure Resource Graph Query
</span></span><span style="display:flex;"><span><span style="color:#f92672">//</span> Provides a list <span style="color:#66d9ef">of</span> Azure VMware Solution resources that don<span style="color:#e6db74">&#39;t have one or more service health alerts covering AVS private clouds in the deployed subscription and region pairs.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">//full list of private clouds
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">(resources
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| where [&#39;</span><span style="color:#66d9ef">type</span><span style="color:#e6db74">&#39;] == &#34;microsoft.avs/privateclouds&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| extend locale = location
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| project id, name, tags, subscriptionId, locale)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| join kind=leftouter
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">//Alert ID&#39;</span>s that include <span style="color:#66d9ef">all</span> incident types filtered <span style="color:#66d9ef">by</span> AVS Service Health alerts
</span></span><span style="display:flex;"><span>((resources
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> <span style="color:#66d9ef">type</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;microsoft.insights/activitylogalerts&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> extend alertproperties <span style="color:#f92672">=</span> todynamic(properties)
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> alertproperties.condition.allOf[<span style="color:#ae81ff">0</span>].field <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;category&#34;</span> <span style="color:#66d9ef">and</span> alertproperties.condition.allOf[<span style="color:#ae81ff">0</span>].<span style="color:#66d9ef">equals</span> <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;ServiceHealth&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> alertproperties.condition.allOf[<span style="color:#ae81ff">1</span>].field <span style="color:#f92672">==</span> <span style="color:#e6db74">&#34;properties.impactedServices[*].ServiceName&#34;</span> <span style="color:#66d9ef">and</span> set_has_element(alertproperties.condition.allOf[<span style="color:#ae81ff">1</span>].containsAny, <span style="color:#e6db74">&#34;Azure VMware Solution&#34;</span>)
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> extend locale <span style="color:#f92672">=</span> strcat_array(split(tolower(alertproperties.condition.allOf[<span style="color:#ae81ff">2</span>].containsAny),<span style="color:#e6db74">&#39; &#39;</span>), <span style="color:#e6db74">&#39;&#39;</span>)
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> mv<span style="color:#f92672">-</span>expand todynamic(locale)
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">where</span> locale <span style="color:#f92672">!=</span> <span style="color:#e6db74">&#34;global&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> project subscriptionId, tostring(locale) )
</span></span><span style="display:flex;"><span><span style="color:#f92672">|</span> <span style="color:#66d9ef">union</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">//</span>Alert ID<span style="color:#e6db74">&#39;s that include only some of the incident types after filtering by service health alerts covering AVS private clouds.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">(resources
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| where type == &#34;microsoft.insights/activitylogalerts&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| extend alertproperties = todynamic(properties)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| where alertproperties.condition.allOf[0].field == &#34;category&#34; and alertproperties.condition.allOf[0].equals == &#34;ServiceHealth&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| where alertproperties.condition.allOf[2].field == &#34;properties.impactedServices[*].ServiceName&#34; and set_has_element(alertproperties.condition.allOf[2].containsAny, &#34;Azure VMware Solution&#34;)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| extend locale = strcat_array(split(tolower(alertproperties.condition.allOf[3].containsAny),&#39;</span> <span style="color:#e6db74">&#39;), &#39;&#39;)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| mv-expand todynamic(locale)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| mv-expand alertproperties.condition.allOf[1].anyOf
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| extend incidentType = alertproperties_condition_allOf_1_anyOf.equals
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| where locale != &#34;global&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| project id, subscriptionId, locale, incidentType
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| distinct subscriptionId, tostring(locale), tostring(incidentType)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| summarize incidentTypes=count() by subscriptionId, locale
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| where incidentTypes == 5 //only include this subscription, region pair if it includes all the incident types.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| project subscriptionId, locale)) on subscriptionId, locale
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| where subscriptionId1 == &#34;&#34; or locale1 == &#34;&#34; or isnull(subscriptionId1) or isnull(locale1)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| project recommendationId = &#34;avs-1&#34;, name, id, tags, param1 = &#34;avsServiceHealthAlertsAllIncidentTypesConfigured: False&#34;
</span></span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>
<h3 id="avs-2---configure-syslog-in-diagnostic-settings-for-azure-vmware-solution">AVS-2 - Configure Syslog in Diagnostic Settings for Azure VMware Solution
  <a href="#avs-2---configure-syslog-in-diagnostic-settings-for-azure-vmware-solution">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: Monitoring</strong></p>
<p><strong>Impact: Medium</strong></p>
<p><strong>Recommendation/Guidance</strong></p>
<p>Ensure Diagnostic Settings are configured for each private cloud to send the syslogs to one or more external sources for analysis and/or archiving.</p>
<p>Azure VMware Solution Syslogs have useful data for troubleshooting and performance that can help with quicker issue resolution and can also enable early detection of some kinds of issues. Configure Diagnostic Settings on the private cloud to send the Syslogs to one or more external sources for querying and/or archiving in case of an audit.</p>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/azure/well-architected/azure-vmware/monitoring#manage-logs-and-archives">Learn More</a></li>
</ul>
<p><strong>Resource Graph Query</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_481d94be0d" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_481d94be0d">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_b581ba5583">
        Copy
        </button>
    </div>
    <div id="clipboard_b581ba5583">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> <span style="color:#66d9ef">under</span><span style="color:#f92672">-</span>development
</span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>
<h3 id="avs-3---configure-azure-monitor-alert-warning-thresholds-for-vsan-datastore-utilization">AVS-3 - Configure Azure Monitor Alert warning thresholds for vSAN datastore utilization
  <a href="#avs-3---configure-azure-monitor-alert-warning-thresholds-for-vsan-datastore-utilization">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: Monitoring</strong></p>
<p><strong>Impact: High</strong></p>
<p><strong>Recommendation/Guidance</strong></p>
<p>Ensure storage utilization is monitored and alerts are configured so that VMware vSAN datastore slack space is maintained at the level the service-level agreement (SLA) mandates.</p>
<p>For service-level agreement (SLA) purposes, Azure VMware Solution requires 25% slack space available on vSAN. vSAN storage utilization should be regularly monitored, and alerts should be configured at 70% utilization (30% slack space available on vSAN) and 75% utilization (25% slack space available on vSAN) to provide enough time for capacity planning.</p>
<p>To expand the vSAN datastore, additional hosts can be added, up to the maximum supported cluster size (16 hosts). Note, you may need to request host quota. In addition, external storage can be added (e.g. Azure Elastic SAN, Azure NetApp Files, Pure Cloud Block Storage) if the CPU and RAM requirements are being met by the Azure VMware Solution cluster.</p>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/azure/azure-vmware/configure-alerts-for-azure-vmware-solution#supported-metrics-and-activities">Learn More</a></li>
</ul>
<p><strong>Resource Graph Query</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_b8c1d6447a" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_b8c1d6447a">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_cb140c9bee">
        Copy
        </button>
    </div>
    <div id="clipboard_cb140c9bee">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> Azure Resource Graph Query
</span></span><span style="display:flex;"><span><span style="color:#f92672">//</span> Provides a list <span style="color:#66d9ef">of</span> Azure VMware Solution resources that don<span style="color:#e6db74">&#39;t have a vSAN capacity critical alert with a threshold of 75% or a warning capacity of 70%.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">(
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">resources
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| where [&#39;</span><span style="color:#66d9ef">type</span><span style="color:#e6db74">&#39;] == &#34;microsoft.avs/privateclouds&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| extend scopeId = tostring(id)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| project [&#39;</span>scopeId<span style="color:#e6db74">&#39;], name, id, tags
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| join kind=leftouter (
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">resources
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| where type == &#34;microsoft.insights/metricalerts&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| extend alertProperties = todynamic(properties)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| mv-expand alertProperties.scopes
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| mv-expand alertProperties.criteria.allOf
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| extend scopeId = tostring(alertProperties_scopes)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| extend metric = alertProperties_criteria_allOf.metricName
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| extend threshold = alertProperties_criteria_allOf.threshold
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| project scopeId, tostring(metric), toint([&#39;</span>threshold<span style="color:#e6db74">&#39;])
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| where metric == &#34;DiskUsedPercentage&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| where threshold == 75
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">) on scopeId
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| where isnull([&#39;</span>threshold<span style="color:#e6db74">&#39;])
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| project recommendationId = &#34;avs-3&#34;, name, id, tags, param1 = &#34;vsanCapacityCriticalAlert: isNull or threshold != 75&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| union (
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">resources
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| where [&#39;</span><span style="color:#66d9ef">type</span><span style="color:#e6db74">&#39;] == &#34;microsoft.avs/privateclouds&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| extend scopeId = tostring(id)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| project [&#39;</span>scopeId<span style="color:#e6db74">&#39;], name, id, tags
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| join kind=leftouter (
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">resources
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| where type == &#34;microsoft.insights/metricalerts&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| extend alertProperties = todynamic(properties)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| mv-expand alertProperties.scopes
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| mv-expand alertProperties.criteria.allOf
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| extend scopeId = tostring(alertProperties_scopes)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| extend metric = alertProperties_criteria_allOf.metricName
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| extend threshold = alertProperties_criteria_allOf.threshold
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| project scopeId, tostring(metric), toint([&#39;</span>threshold<span style="color:#e6db74">&#39;])
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| where metric == &#34;DiskUsedPercentage&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| where threshold == 70
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">) on scopeId
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| where isnull([&#39;</span>threshold<span style="color:#e6db74">&#39;])
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| project recommendationId = &#34;avs-3&#34;, name, id, tags, param1 = &#34;vsanCapacityWarningAlert: isNull or threshold != 70&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">)
</span></span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>
<h3 id="avs-4---enable-stretched-clusters-for-multi-az-availability-of-the-vsan-datastore">AVS-4 - Enable Stretched Clusters for Multi-AZ Availability of the vSAN Datastore
  <a href="#avs-4---enable-stretched-clusters-for-multi-az-availability-of-the-vsan-datastore">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: Availability</strong></p>
<p><strong>Impact: Low</strong></p>
<p><strong>Recommendation/Guidance</strong></p>
<p>If a Multi-AZ deployment of Azure VMware Solution is required, needs a financially backed SLA of 99.99%, or needs synchronous storage replication between AZs (RPO=0), then Azure VMware Solution Stretched Clusters should be considered. If you are in a region that supports stretched clusters, consider enabling this feature to spread the VMware vSAN datastore across two availability zones. Note: Configuring an Azure VMware Solution private cloud as a stretched cluster can only be done during initial implementation and requires twice the quota. This is due to a stretched cluster extending the cluster to the second availability zone.</p>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/azure/well-architected/azure-vmware/infrastructure#implement-high-availability">Learn More</a></li>
<li><a href="https://learn.microsoft.com/en-us/azure/azure-vmware/deploy-vsan-stretched-clusters">Stretched Clusters</a></li>
</ul>
<p><strong>Resource Graph Query</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_7b21b404db" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_7b21b404db">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_1d760f3e51">
        Copy
        </button>
    </div>
    <div id="clipboard_1d760f3e51">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> Azure Resource Graph Query
</span></span><span style="display:flex;"><span><span style="color:#f92672">//</span> Provides a list <span style="color:#66d9ef">of</span> Azure VMware Solution resources that aren<span style="color:#e6db74">&#39;t configured as stretched clusters and in supported regions.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">resources
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| where [&#39;</span><span style="color:#66d9ef">type</span><span style="color:#e6db74">&#39;] == &#34;microsoft.avs/privateclouds&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| extend avsproperties = todynamic(properties)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| where avsproperties.availability.strategy != &#34;DualZone&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| where location in (&#34;uksouth&#34;, &#34;westeurope&#34;, &#34;germanywestcentral&#34;, &#34;australiaeast&#34;)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| project recommendationId = &#34;avs-4&#34;, name, id, tags, param1 = &#34;stretchClusters: Disabled&#34;
</span></span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>
<h3 id="avs-5---monitor-cpu-utilization-to-ensure-sufficient-resources-for-workloads">AVS-5 - Monitor CPU Utilization to ensure sufficient resources for workloads
  <a href="#avs-5---monitor-cpu-utilization-to-ensure-sufficient-resources-for-workloads">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: Monitoring</strong></p>
<p><strong>Impact: Medium</strong></p>
<p><strong>Recommendation/Guidance</strong></p>
<p>Ensure there are enough compute resources to avoid host resource exhaustion. Azure VMware Solution uses vSphere DRS and vSphere HA to manage workload resources dynamically. However, sustained host CPU utilization of over 95% can contribute to high CPU Ready times, which will impact running workloads.</p>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/azure/well-architected/azure-vmware/monitoring#configure-and-streamline-alerts">Learn More</a></li>
</ul>
<p><strong>Resource Graph Query</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_37728689ab" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_37728689ab">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_e23caed62d">
        Copy
        </button>
    </div>
    <div id="clipboard_e23caed62d">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> Azure Resource Graph Query
</span></span><span style="display:flex;"><span><span style="color:#f92672">//</span> Provides a list <span style="color:#66d9ef">of</span> Azure VMware Solution resources that don<span style="color:#e6db74">&#39;t have a Cluster CPU capacity critical alert with a threshold of 95%.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">resources
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| where [&#39;</span><span style="color:#66d9ef">type</span><span style="color:#e6db74">&#39;] == &#34;microsoft.avs/privateclouds&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| extend scopeId = tostring(id)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| project [&#39;</span>scopeId<span style="color:#e6db74">&#39;], name, id, tags
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| join kind=leftouter (
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">resources
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| where type == &#34;microsoft.insights/metricalerts&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| extend alertProperties = todynamic(properties)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| mv-expand alertProperties.scopes
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| mv-expand alertProperties.criteria.allOf
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| extend scopeId = tostring(alertProperties_scopes)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| extend metric = alertProperties_criteria_allOf.metricName
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| extend threshold = alertProperties_criteria_allOf.threshold
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| project scopeId, tostring(metric), toint([&#39;</span>threshold<span style="color:#e6db74">&#39;])
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| where metric == &#34;EffectiveCpuAverage&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| where threshold == 95
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">) on scopeId
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| where isnull([&#39;</span>threshold<span style="color:#e6db74">&#39;])
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| project recommendationId = &#34;avs-5&#34;, name, id, tags, param1 = &#34;hostCpuCriticalAlert: isNull or threshold != 95&#34;
</span></span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>
<h3 id="avs-6---monitor-memory-utilization-to-ensure-sufficient-resources-for-workloads">AVS-6 - Monitor Memory Utilization to ensure sufficient resources for workloads
  <a href="#avs-6---monitor-memory-utilization-to-ensure-sufficient-resources-for-workloads">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: Monitoring</strong></p>
<p><strong>Impact: Medium</strong></p>
<p><strong>Recommendation/Guidance</strong></p>
<p>Ensure there are enough memory resources to avoid host resource exhaustion. Azure VMware Solution uses vSphere DRS and vSphere HA to manage workload resources dynamically. However, sustained host memory utilization of over 95% can contribute to host memory swapping to disk, which will impact running workloads.</p>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/azure/well-architected/azure-vmware/monitoring#configure-and-streamline-alerts">Learn More</a></li>
</ul>
<p><strong>Resource Graph Query</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_4c12a7bce1" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_4c12a7bce1">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_b9ce8564a5">
        Copy
        </button>
    </div>
    <div id="clipboard_b9ce8564a5">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> Azure Resource Graph Query
</span></span><span style="display:flex;"><span><span style="color:#f92672">//</span> Provides a list <span style="color:#66d9ef">of</span> Azure VMware Solution resources that don<span style="color:#e6db74">&#39;t have a cluster host memory critical alert with a threshold of 95%.
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">resources
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| where [&#39;</span><span style="color:#66d9ef">type</span><span style="color:#e6db74">&#39;] == &#34;microsoft.avs/privateclouds&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| extend scopeId = tostring(id)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| project [&#39;</span>scopeId<span style="color:#e6db74">&#39;], name, id, tags
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| join kind=leftouter (
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">resources
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| where type == &#34;microsoft.insights/metricalerts&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| extend alertProperties = todynamic(properties)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| mv-expand alertProperties.scopes
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| mv-expand alertProperties.criteria.allOf
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| extend scopeId = tostring(alertProperties_scopes)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| extend metric = alertProperties_criteria_allOf.metricName
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| extend threshold = alertProperties_criteria_allOf.threshold
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| project scopeId, tostring(metric), toint([&#39;</span>threshold<span style="color:#e6db74">&#39;])
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| where metric == &#34;UsageAverage&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| where threshold == 95
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">) on scopeId
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| where isnull([&#39;</span>threshold<span style="color:#e6db74">&#39;])
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">| project recommendationId = &#34;avs-6&#34;, name, id, tags, param1 = &#34;hostMemoryCriticalAlert: isNull or threshold != 95&#34;
</span></span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>
<h3 id="avs-7---monitor-when-azure-vmware-solution-cluster-size-is-approaching-the-host-limit">AVS-7 - Monitor when Azure VMware Solution Cluster Size is approaching the host limit
  <a href="#avs-7---monitor-when-azure-vmware-solution-cluster-size-is-approaching-the-host-limit">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: Monitoring</strong></p>
<p><strong>Impact: Medium</strong></p>
<p><strong>Recommendation/Guidance</strong></p>
<p>Alert when the cluster size of 14 hosts is reached. Additionally, periodic alerts should be set up to indicate when growth, especially driven by storage requirements, necessitates planning for a new cluster or the addition of extra datastores. Furthermore, beyond the threshold of 14 hosts, alerts should be triggered each time a new host is added to the cluster, allowing proactive monitoring and management of resource utilization.</p>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/azure/well-architected/azure-vmware/monitoring#configure-and-streamline-alerts">Learn More</a></li>
</ul>
<p><strong>Resource Graph Query</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_481d94be0d" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_481d94be0d">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_b581ba5583">
        Copy
        </button>
    </div>
    <div id="clipboard_b581ba5583">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> <span style="color:#66d9ef">under</span><span style="color:#f92672">-</span>development
</span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>
<h3 id="avs-8---monitor-when-azure-vmware-solution-private-cloud-is-reaching-the-capacity-limit">AVS-8 - Monitor when Azure VMware Solution Private Cloud is reaching the capacity limit
  <a href="#avs-8---monitor-when-azure-vmware-solution-private-cloud-is-reaching-the-capacity-limit">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: Monitoring</strong></p>
<p><strong>Impact: Medium</strong></p>
<p><strong>Recommendation/Guidance</strong></p>
<p>Alert when the total node count is greater than or equal to 90 hosts so that it&rsquo;s clear when to start planning for a new private cloud.</p>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/azure/well-architected/azure-vmware/monitoring#configure-and-streamline-alerts">Configure and streamline alerts</a></li>
</ul>
<p><strong>Resource Graph Query</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_481d94be0d" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_481d94be0d">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_b581ba5583">
        Copy
        </button>
    </div>
    <div id="clipboard_b581ba5583">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> <span style="color:#66d9ef">under</span><span style="color:#f92672">-</span>development
</span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>
<h3 id="avs-9---apply-resource-delete-lock-on-the-resource-group-hosting-the-private-cloud">AVS-9 - Apply Resource delete lock on the resource group hosting the private cloud
  <a href="#avs-9---apply-resource-delete-lock-on-the-resource-group-hosting-the-private-cloud">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: Governance</strong></p>
<p><strong>Impact: High</strong></p>
<p><strong>Recommendation/Guidance</strong></p>
<p>Anyone with contributor access to the resource group hosting Azure VMware Solution Private Cloud can delete it. Applying a resource delete lock to the Azure VMware Solution Private Cloud resource group to prevent deletion of the Azure VMware Solution Private Cloud.</p>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/azure/azure-resource-manager/management/lock-resources">Lock your resources to protect your infrastructure</a></li>
</ul>
<p><strong>Resource Graph Query</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_b187a04018" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_b187a04018">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_5b6624f824">
        Copy
        </button>
    </div>
    <div id="clipboard_5b6624f824">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> cannot be validated <span style="color:#66d9ef">with</span> ARG
</span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>
<h3 id="avs-10---align-expressroute-configuration-with-best-practices-for-circuit-resilience">AVS-10 - Align ExpressRoute configuration with best practices for circuit resilience
  <a href="#avs-10---align-expressroute-configuration-with-best-practices-for-circuit-resilience">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: Networking</strong></p>
<p><strong>Impact: High</strong></p>
<p><strong>Recommendation/Guidance</strong></p>
<p>For critical workloads, Microsoft recommends deploying two (or more) ExpressRoute circuits in different ExpressRoute peering locations. Use Global Reach to connect multiple ExpressRoute circuits and your Azure VMware Solutions private clouds. Please review the APRL recommendations for ExpressRoute circuits in the Resources section below.</p>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://azure.github.io/Azure-Proactive-Resiliency-Library/services/networking/expressroute-circuits">APRL guidance for ExpressRoute circuits</a></li>
<li><a href="https://learn.microsoft.com/azure/expressroute/expressroute-howto-circuit-portal-resource-manager?pivots=expressroute-preview#create-a-new-expressroute-circuit-preview">Create a new ExpressRoute circuit</a></li>
</ul>
<p><strong>Resource Graph Query/Scripts</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_481d94be0d" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_481d94be0d">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_b581ba5583">
        Copy
        </button>
    </div>
    <div id="clipboard_b581ba5583">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> <span style="color:#66d9ef">under</span><span style="color:#f92672">-</span>development
</span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>
<h3 id="avs-11---deploy-two-or-more-circuits-in-different-peering-locations-when-using-stretched-clusters">AVS-11 - Deploy two or more circuits in different peering locations when using stretched clusters
  <a href="#avs-11---deploy-two-or-more-circuits-in-different-peering-locations-when-using-stretched-clusters">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: Networking</strong></p>
<p><strong>Impact: High</strong></p>
<p><strong>Recommendation/Guidance</strong></p>
<p>Azure VMware Solution vSAN stretched clusters span two Availability Zones (AZs) in the region where they are deployed (plus a third AZ for the witness node). When using ExpressRoute to connect to the vSAN stretched clusters from  on-premises, align the ExpressRoute implementation&rsquo;s resilience to the clusters’ resilience by deploying two circuits in different peering locations (i.e., different sites/DC facilities). When using Global Reach, implement a  mesh topology by connecting the on-premises circuits to the managed circuits provided by the Azure VMware Solution private cloud.</p>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/azure/azure-vmware/deploy-vsan-stretched-clusters#deploy-a-stretched-cluster-private-cloud">Deploy vSAN streched cluster</a></li>
</ul>
<p><strong>Resource Graph Query/Scripts</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_b187a04018" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_b187a04018">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_5b6624f824">
        Copy
        </button>
    </div>
    <div id="clipboard_5b6624f824">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> cannot be validated <span style="color:#66d9ef">with</span> ARG
</span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>
<h3 id="avs-12---deploy-two-azure-vmware-solution-private-clouds-in-different-regions-for-geographical-disaster-recovery">AVS-12 - Deploy two Azure VMware Solution private clouds in different regions for geographical disaster recovery
  <a href="#avs-12---deploy-two-azure-vmware-solution-private-clouds-in-different-regions-for-geographical-disaster-recovery">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: Disaster Recovery</strong></p>
<p><strong>Impact: High</strong></p>
<p><strong>Recommendation/Guidance</strong></p>
<p>Two Azure VMware Solution private clouds can be deployed in different regions for business continuity. Implement a mesh network topology based on ExpressRoute Gateway Connections and Global Reach Connections.</p>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/azure/azure-vmware/move-azure-vmware-solution-across-regions">Private Clouds in two regions</a></li>
<li><a href="https://learn.microsoft.com/en-us/azure/cloud-adoption-framework/scenarios/azure-vmware/eslz-dual-region-network-topology">Dual Region Network Topology</a></li>
</ul>
<p><strong>Resource Graph Query/Scripts</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_b187a04018" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_b187a04018">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_5b6624f824">
        Copy
        </button>
    </div>
    <div id="clipboard_5b6624f824">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> cannot be validated <span style="color:#66d9ef">with</span> ARG
</span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>
<h3 id="avs-13---use-the-avs-interconnect-feature-to-connect-private-clouds-in-different-availability-zones">AVS-13 - Use the AVS Interconnect feature to connect private clouds in different availability zones
  <a href="#avs-13---use-the-avs-interconnect-feature-to-connect-private-clouds-in-different-availability-zones">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: Availability</strong></p>
<p><strong>Impact: High</strong></p>
<p><strong>Recommendation/Guidance</strong></p>
<p>Use the Interconnect feature for direct communication between private clouds in different availability zones, enabling connectivity between the private clouds management and workload networks. The IP address for each private cloud should be unique to avoid overlap, as the AVS Interconnect does not check for this.</p>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/azure/azure-vmware/connect-multiple-private-clouds-same-region">Connect Private Clouds in the same region</a></li>
</ul>
<p><strong>Resource Graph Query/Scripts</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_b187a04018" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_b187a04018">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_5b6624f824">
        Copy
        </button>
    </div>
    <div id="clipboard_5b6624f824">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> cannot be validated <span style="color:#66d9ef">with</span> ARG
</span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>
<h3 id="avs-14---use-key-autorotation-for-vsan-datastore-customer-managed-keys">AVS-14 - Use key autorotation for vSAN datastore customer-managed keys
  <a href="#avs-14---use-key-autorotation-for-vsan-datastore-customer-managed-keys">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: Storage</strong></p>
<p><strong>Impact: High</strong></p>
<p><strong>Recommendation/Guidance</strong></p>
<p>When using customer-managed keys to encrypt the vSAN datastore(s), use Azure Key Vault for centralized management and access them using a managed identity mapped to the private cloud. Key expiration can result in the vSAN datastore and its workloads becoming unavailable. Configure key autorotation to avoid unplanned outages due to key rotation not occurring before expiration.</p>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/azure/azure-vmware/configure-customer-managed-keys?tabs=azure-portal">Configure Customer Managed Keys</a></li>
</ul>
<p><strong>Resource Graph Query/Scripts</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_b187a04018" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_b187a04018">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_5b6624f824">
        Copy
        </button>
    </div>
    <div id="clipboard_5b6624f824">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> cannot be validated <span style="color:#66d9ef">with</span> ARG
</span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>
<h3 id="avs-15---configure-ldaps-identity-integration-with-two-sources-for-nsx-and-vcenter-server-management-consoles">AVS-15 - Configure LDAPS Identity integration with two sources for NSX and vCenter Server management consoles
  <a href="#avs-15---configure-ldaps-identity-integration-with-two-sources-for-nsx-and-vcenter-server-management-consoles">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: Access and Security</strong></p>
<p><strong>Impact: High</strong></p>
<p><strong>Recommendation/Guidance</strong></p>
<p>Ensure that two external identity sources are configured for NSX and vCenter Server. The VMware vCenter Server and NSX Manager use identity sources to enable authentication using external identities. These sources can be temporarily unavailable during maintenance times. Having two sources ensures that administrators can continue to log in to the control surfaces when one source becomes unavailable.</p>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/azure/azure-vmware/configure-identity-source-vcenter">Set an external identity source for vCenter</a></li>
<li><a href="https://learn.microsoft.com/en-us/azure/azure-vmware/configure-external-identity-source-nsx-t">Set an external identity for NSX-T</a></li>
</ul>
<p><strong>Resource Graph Query/Scripts</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_b187a04018" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_b187a04018">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_5b6624f824">
        Copy
        </button>
    </div>
    <div id="clipboard_5b6624f824">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> cannot be validated <span style="color:#66d9ef">with</span> ARG
</span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>
<h3 id="avs-16---use-hcx-network-extension-high-availability">AVS-16 - Use HCX Network Extension High Availability
  <a href="#avs-16---use-hcx-network-extension-high-availability">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: Availability</strong></p>
<p><strong>Impact: High</strong></p>
<p><strong>Recommendation/Guidance</strong></p>
<p>Enable Network Extension High Availability to provide appliance failure tolerance to the HCX Network Extension service. When Network Extension High Availability is enabled for a selected appliance, HCX will pair it with an eligible appliance and enable an Active Standby resiliency configuration. This enables highly available configurations that can remain in-service in the event of an unplanned appliance level failure. When either of the HA Actives fail, both standby appliances take over. The Network Extension High Availability is designed to recover within a few seconds after a single appliance has failed.</p>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/azure/azure-vmware/configure-hcx-network-extension-high-availability">HCX Network extension high availability</a></li>
<li><a href="https://docs.vmware.com/en/VMware-HCX/4.8/hcx-user-guide/GUID-E1353511-697A-44B0-82A0-852DB55F97D7.html">Understanding Network Extension High Availability</a></li>
</ul>
<p><strong>Resource Graph Query/Scripts</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_b187a04018" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_b187a04018">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_5b6624f824">
        Copy
        </button>
    </div>
    <div id="clipboard_5b6624f824">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> cannot be validated <span style="color:#66d9ef">with</span> ARG
</span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>
<h3 id="avs-17---verify-management-networks-are-not-extended-with-hcx-network-extension">AVS-17 - Verify Management Networks are not extended with HCX Network Extension
  <a href="#avs-17---verify-management-networks-are-not-extended-with-hcx-network-extension">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: Networking</strong></p>
<p><strong>Impact: High</strong></p>
<p><strong>Recommendation/Guidance</strong></p>
<p>Do not extend the network on which the HCX Management devices are deployed.</p>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://docs.vmware.com/en/VMware-HCX/4.8/hcx-user-guide/GUID-0C746416-850E-46F7-85DD-4D4326A23785.html">Requirements for Network Extension</a></li>
</ul>
<p><strong>Resource Graph Query/Scripts</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_b187a04018" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_b187a04018">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_5b6624f824">
        Copy
        </button>
    </div>
    <div id="clipboard_5b6624f824">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> cannot be validated <span style="color:#66d9ef">with</span> ARG
</span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>
<h3 id="avs-18---use-multiple-dns-servers-per-private-fqdn-zone">AVS-18 - Use multiple DNS servers per private FQDN zone
  <a href="#avs-18---use-multiple-dns-servers-per-private-fqdn-zone">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: Networking</strong></p>
<p><strong>Impact: High</strong></p>
<p><strong>Recommendation/Guidance</strong></p>
<p>Azure VMware Solution private clouds can support upto three DNS servers for a single FQDN. Using a single DNS server for DNS resolution becomes single point of failure. Ensure that multiple DNS servers are used for any on-premises FQDN resolution from each Azure VMware Solution private cloud.</p>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/azure/azure-vmware/configure-dns-azure-vmware-solution#configure-dns-forwarder">Configure DNS forwarder</a></li>
</ul>
<p><strong>Resource Graph Query/Scripts</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_b187a04018" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_b187a04018">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_5b6624f824">
        Copy
        </button>
    </div>
    <div id="clipboard_5b6624f824">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> cannot be validated <span style="color:#66d9ef">with</span> ARG
</span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>
<h3 id="avs-19---verify-vsan-ftt-configuration-aligns-with-the-cluster-size">AVS-19 - Verify vSAN FTT configuration aligns with the cluster size
  <a href="#avs-19---verify-vsan-ftt-configuration-aligns-with-the-cluster-size">
    <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-link" viewBox="0 0 16 16">
      <path d="M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z"/>
      <path d="M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z"/>
    </svg>
  </a>
</h3>
<p><strong>Category: Application Resilience</strong></p>
<p><strong>Impact: High</strong></p>
<p><strong>Recommendation/Guidance</strong></p>
<p>The Azure VMware Solution service SLA also depends upon the vSAN storage policies configured, which vary depending upon the cluster size. In clusters with more than 6 hosts, the vSAN storage policy should be configured with an FTT-2 policy (RAID-1, or RAID-6). FTT stands for <strong>failures to tolerate</strong>, which in this case refers to how many hosts in a cluster can fail, beofre there is potential data or VM impact.</p>
<p>The default storage policy is set to RAID-1 FTT-1, with Object Space Reservation set to Thin provisioning. Unless you adjust the storage policy or apply a new policy, the cluster grows with this configuration. Please note that the storage policy is not automatically updated based on cluster size. Similarly, changing the default does not automatically update the running VM policies.</p>
<p><strong>Resources</strong></p>
<ul>
<li><a href="https://learn.microsoft.com/en-us/azure/well-architected/azure-vmware/application-platform#use-fault-domains">Use fault domains</a></li>
<li><a href="https://learn.microsoft.com/en-us/azure/azure-vmware/configure-storage-policy">Configure storage policy</a></li>
</ul>
<p><strong>Resource Graph Query/Scripts</strong></p>


<button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#collapse_b187a04018" aria-expanded="false">
    Show/Hide Query/Script
</button>

<div class="collapse" id="collapse_b187a04018">
  <div class="card card-body">
    







    
    




<div class="position-relative">
    <div class="position-absolute" style="right:0;">
        <button class="btn btn-light" data-clipboard-target="#clipboard_5b6624f824">
        Copy
        </button>
    </div>
    <div id="clipboard_5b6624f824">
    <div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#f92672">//</span> cannot be validated <span style="color:#66d9ef">with</span> ARG
</span></span></code></pre></div>
    </div>
</div>






  </div>
</div>
<p><br><br></p>


    



          <div class="row"></div> 

        </div>

      </div> 

    </div> 
<script src="http://localhost:1313/Azure-Proactive-Resiliency-Library/lib/jquery.min.js"></script> 
<script src="http://localhost:1313/Azure-Proactive-Resiliency-Library/lib/popper.min.js"></script> 

<script src="http://localhost:1313/Azure-Proactive-Resiliency-Library/js/bootstrap.min.js"></script> 


<script type="text/javascript" src="/Azure-Proactive-Resiliency-Library/plugins/lunr.min.js"></script>
<script type="text/javascript" src="/Azure-Proactive-Resiliency-Library/plugins/auto-complete.js"></script>
<link href="/Azure-Proactive-Resiliency-Library/plugins/auto-complete.css" rel="stylesheet">
<script type="text/javascript">
  
      var baseurl = "http:\/\/localhost:1313\/Azure-Proactive-Resiliency-Library\/";
  
</script>
<script type="text/javascript" src="/Azure-Proactive-Resiliency-Library/plugins/search.js"></script>

<script type="text/javascript" src="/Azure-Proactive-Resiliency-Library/plugins/favorites.js"></script>


<script type="text/javascript" src="/Azure-Proactive-Resiliency-Library/plugins/clipboard.js"></script>
<script>
  new ClipboardJS('.btn');
</script>
</body>

</html>
